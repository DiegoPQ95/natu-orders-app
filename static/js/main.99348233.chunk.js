(this["webpackJsonpnatu-app"]=this["webpackJsonpnatu-app"]||[]).push([[0],{322:function(e,t,a){e.exports=a(445)},445:function(e,t,a){"use strict";a.r(t),Number.prototype.toCurrency=function(){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(this)},Number.prototype.moneyRound=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=!1,a=this,n=e;void 0===n&&(n=0),a<0&&(t=!0,a*=-1);var r=Math.pow(10,n);return a=parseFloat((a*r).toFixed(11)),a=(Math.round(a)/r).toFixed(n),t&&(a=(-1*a).toFixed(n)),+a};var n=a(0),r=a.n(n),o=a(19),i=a.n(o);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(9),c=a(10),s=a(14),u=a(13),d=a(31),m=a(46),p=a(7),h=a(25),f=a(469),g=a(472),v=a(268),E=a(473),b=a(202),y=a(47),O=a(269),C=a(476),A="https://natuapp.ue.r.appspot.com",S=new(function(){function e(){Object(l.a)(this,e),this.KEY=""}return Object(c.a)(e,[{key:"Login",value:function(e){return this.F("user/login",{body:e,method:"POST"})}},{key:"GetProducts",value:function(e){return this.F("product"+(e?"?todos=1":""))}},{key:"SendProductAction",value:function(e,t){return this.F("product/"+e,{body:{action:t},method:"PATCH"})}},{key:"GetOrders",value:function(){return this.F("order")}},{key:"GetOrder",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return this.F("order/"+e)}))},{key:"SaveOrder",value:function(e){return this.F("order",{method:"POST",body:e})}},{key:"ActionOrder",value:function(e,t){return this.F("order/"+e,{method:"PUT",body:t})}},{key:"Stats",value:function(e){var t=new URLSearchParams;return t.set("data",e.stats.join(",")),e.semana&&t.set("semana",e.semana.toString()),e.year&&t.set("year",e.year.toString()),isNaN(+e.cycleIndex)||t.set("cycleIndex",e.cycleIndex.toString()),this.F("dashboard?"+t.toString())}},{key:"ProductSalesReport",value:function(e){var t="";return e&&Object.keys(e).length&&(t="?"+new URLSearchParams(e).toString()),this.F("reports/product-sales"+t)}},{key:"GetGroups",value:function(){return this.F("user/groups")}},{key:"SignIn",value:function(e){return this.F("user",{method:"POST",body:e})}},{key:"GetUsers",value:function(e,t){var a=new URLSearchParams;return e&&e.length&&a.set("cols",e.join(",")),t&&a.set("rol",t.toString()),this.F("user"+(a.toString()?"?"+a.toString():""))}},{key:"GetUser",value:function(e){return this.F("user/"+e)}},{key:"SaveUser",value:function(e){return this.F("user"+(e.id?"/".concat(e.id):""),{method:e.id?"PUT":"POST",body:e})}},{key:"DeleteUser",value:function(e){return this.F("user/"+e,{method:"DELETE"})}},{key:"SendUserAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.F("user"+(null===t?"":"/".concat(t)),{method:"PATCH",body:{action:e}})}},{key:"SaveProduct",value:function(e){return this.F("product"+(e.id?"/"+e.id:""),{method:e.id?"PUT":"POST",body:e})}},{key:"DeleteProduct",value:function(e){return this.F("product/"+e,{method:"DELETE"})}},{key:"ServerURL",value:function(){return A}},{key:"GetGiftRules",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.F("gift-rules?"+(e?"all=1":""),{method:"GET"})}},{key:"SaveGiftRule",value:function(e){return this.F("gift-rules/",{method:"POST",body:e})}},{key:"DeleteGiftRule",value:function(e){return this.F("gift-rules/".concat(e),{method:"DELETE"})}},{key:"GetCycles",value:function(){return this.F("cycles/",{method:"GET"})}},{key:"GetMultiLevelUserData",value:function(e){return this.F("cycles/data?cycleIndex="+e.index,{method:"GET"})}},{key:"processMultiLevelUserData",value:function(e){}},{key:"Rangos",value:function(){return Promise.resolve([{id:"A",nombre:"Asesor"},{id:"LN",nombre:"Luna Nueva"},{id:"LC",nombre:"Luna Creciente"},{id:"LL",nombre:"Luna Llena"},{id:"LA",nombre:"Luna Azul"},{id:"GT",nombre:"Guia de Tribu"},{id:"GGT",nombre:"Gra Guia de Tribu"}])}},{key:"F",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={method:"GET",cache:"reload",mode:"cors"},n=Object(p.a)(Object(p.a)({},a),t);return n.headers||(n.headers={}),n.headers["Content-Type"]="application/json",n.headers["Access-Control-Allow-Origin"]="*",this.KEY&&(n.headers||(n.headers={}),n.headers.Authorization="Basic "+this.KEY),n.body&&"string"!==typeof n.body&&(n.body=JSON.stringify(n.body)),fetch(A+"/"+e,n).then((function(e){return e.ok?e.json():e.clone().json().catch((function(){return e.text().then((function(t){throw{message:t,status:e.status,statusText:e.statusText}}))})).then((function(t){throw Object(p.a)(Object(p.a)({},t),{},{status:e.status,statusText:e.statusText})}))})).catch((function(e){if("Failed to fetch"===e.message)throw{message:"Este servicio no se encuentra disponible por el momento. Intentelo m\xe1s tarde.",status:0};throw e.message||(e.message=e.statusText),e}))}}]),e}()),D=a(474),w=a(475),_=a(37),T="",x=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"setPrefix",value:function(e){T=e||""}},{key:"Get",value:function(e){var t=T+e,a=window.localStorage.getItem(t);try{return JSON.parse(a)}catch(n){}return a}},{key:"Set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=T+e;if(void 0!==t)if(null!==t){var n=t;typeof t===typeof{}&&(n=JSON.stringify(t)),window.localStorage.setItem(a,n)}else window.localStorage.removeItem(a);else window.localStorage.removeItem(a)}},{key:"NormalizeProductoSelecciones",value:function(e,t){if(!e||!Object.keys(e).length)return!1;var a=function(a){if(!(r=t.find((function(e){return e.id===+a})))||!r.opciones||!r.opciones.length)return delete e[a],"continue";o=(o=e[a]).filter((function(e){return e.filter((function(e){return t.find((function(t){return t.id===+e}))})).length===e.length})),e[a]=o,e[a].length||delete e[a]};for(var n in e){var r,o;a(n)}return Object.keys(e).length>0}}]),e}(),k=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state=new I,n.handleChange=function(e){var t=e.currentTarget,a=t.name,r=t.value;n.setState(Object(h.a)({},a,r))},n.handleSubmit=function(e){if(e.preventDefault(),!n.state.loading){var t=n.state.user&&n.state.user.toString().trim(),a=n.state.pwd&&n.state.pwd.toString().trim();if(!t)return n.setState({error:{message:"Digite su usuario"}});if(!a)return n.setState({error:{message:"Digite su contrase\xf1a"}});n.setState({loading:!0,error:null}),S.Login({user:t,pwd:a}).then((function(e){x.Set("user",t),n.setState({loading:null}),n.props.onLoggedIn(Object(p.a)({},e))})).catch((function(e){return n.setState({loading:null,error:e})}))}},n.handlePassword=function(e){n.setState((function(e){var t=Object(p.a)({},e);return t.isPasswordVisible=!t.isPasswordVisible,t}))},S.KEY="",n.state.user=x.Get("user")||"",n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return window.requestAnimationFrame((function(){e.state.user?document.getElementById("password-textfield").focus():document.getElementById("user-textfield").focus()}))}),100)}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.error,n=e.user,o=e.pwd,i=e.isPasswordVisible;return r.a.createElement("div",{style:{paddingTop:20}},r.a.createElement(f.a,{style:{width:"100%",maxWidth:300,margin:"auto",textAlign:"center"}},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(g.a,null,r.a.createElement("img",{src:"./logo.png",alt:"Logo",style:{height:150,minHeight:150,width:"auto"}}),r.a.createElement(v.a,{inputProps:{id:"user-textfield"},onChange:this.handleChange,value:n,label:"Usuario",name:"user",fullWidth:!0,disabled:t,style:j}),r.a.createElement(v.a,{onChange:this.handleChange,value:o,name:"pwd",label:"Contrase\xf1a",type:i?"input":"password",fullWidth:!0,disabled:t,style:j,inputProps:{id:"password-textfield"},InputProps:{endAdornment:r.a.createElement(E.a,{position:"end"},r.a.createElement(b.a,{onClick:this.handlePassword},i?r.a.createElement(D.a,null):r.a.createElement(w.a,null)))}}),a&&r.a.createElement(y.a,{color:"secondary",variant:"body1",style:{textAlign:"center"}},a.message),r.a.createElement(O.a,{type:"submit",variant:"outlined",style:j,color:"primary",disabled:t,fullWidth:!0},t?"CARGANDO...":"ENTRAR"),r.a.createElement(C.a,{style:{margin:20}}),r.a.createElement(y.a,{style:{display:"block",textAlign:"center",margin:5},variant:"body2",component:_.b,to:"/signin"},"No eres asesor/a nat\xfa? Registrate aqu\xed!")))))}}]),a}(r.a.Component),j={marginTop:10,marginBottom:10},I=function e(){Object(l.a)(this,e),this.user="",this.pwd="",this.loading=!1,this.isPasswordVisible=!1,this.error=null},P=a(38),R=a(4),N=a(509),L=a(525),U=a(523),M=a(497),F=a(74),G=a(498),B=a(16),V=a(483),W=a(485),z=a(23),H=a(477),q=a(478),Y=a(481),K=a(164),Z=a(479),J=a(480),X=a(482),Q=function(e){var t=e.onCardClick,a=e.onActionClick,n=e.controls,o=Object(z.a)(e,["onCardClick","onActionClick","controls"]),i=e,l=e.textStyle||{};return r.a.createElement(f.a,null,t?r.a.createElement(H.a,{name:"card",value:e.id,onClick:t},r.a.createElement($,o)):r.a.createElement($,o),"ADD-REMOVE"===n&&r.a.createElement(q.a,null,r.a.createElement(b.a,{disabled:!(i.cantidad>0),onClick:a,name:"-",value:i.id},r.a.createElement(Z.a,null)),r.a.createElement(y.a,{variant:"body1",style:l},i.cantidad),r.a.createElement(b.a,{onClick:a,name:"+",value:i.id},r.a.createElement(J.a,null))))};function $(e){var t=e,a=e.textStyle||{};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{component:"img",className:"card-product-img",image:t.imgSrc||"https://diegopq95.github.io/take-orders/img/default.png"}),r.a.createElement(g.a,null,r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(y.a,{style:Object(p.a)({flex:1,height:60,overflow:"hidden"},a),variant:"subtitle1"},t.nombre),e.editablePrice?r.a.createElement(K.a,{style:{width:100},type:"number",onChange:e.onPriceChange,value:""+t.pvp_final,name:""+t.id,startAdornment:r.a.createElement(E.a,{position:"start"},r.a.createElement(X.a,null))}):r.a.createElement(y.a,{variant:"h6",style:a},"$ ",t.pvp_final.toFixed(2))),r.a.createElement("div",null,r.a.createElement(y.a,{variant:"caption",style:{display:"inline"},component:t.descripcion_url?"a":"p",target:"_blank",href:t.descripcion_url},t.descripcion_url?"Informaci\xf3n del Producto.":"Sin informaci\xf3n."," "),r.a.createElement(y.a,{variant:"button",style:{display:"inline"}}," Producto ",t.aplica_comision?"":"NO"," comisionable."),r.a.createElement(y.a,{variant:"button",style:{display:"inline"}}," ",t.aplica_descuento?"":"No"," Aplica descuento."))))}var ee=a(484);function te(e){var t={};e.visible||(t.display="none");var a=r.a.useState(""),n=Object(B.a)(a,2),o=n[0],i=n[1],l=e.items.filter((function(e){return!o||e.nombre.toUpperCase().trim().indexOf((o||"").toUpperCase().trim())>=0}));if("fetch-data:loading"===e.async_status)return r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(V.a,{size:100}),r.a.createElement(y.a,{variant:"h6"},"CARGANDO..."));if("fetch-data:completed"===e.async_status&&!l.length)var c=!0;return"fetch-data:error"===e.async_status?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(y.a,{variant:"h4"},"Ocurri\xf3 un error"),e.async_error&&r.a.createElement(y.a,{variant:"h4"},"Ocurri\xf3 un error",e.async_error)):r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{variant:"outlined",fullWidth:!0,placeholder:"Buscar...",style:{padding:10},value:o,type:"search",onChange:function(e){return i(e.target.value)},InputProps:{startAdornment:r.a.createElement(E.a,{position:"start"}," ",r.a.createElement(ee.a,null))}}),c?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(y.a,{variant:"h6"},"No hay productos")):null,r.a.createElement(W.a,{container:!0,alignItems:"center",style:Object(p.a)({flex:1,marginTop:5},t),spacing:3},l.map((function(t){return r.a.createElement(W.a,{item:!0,sm:4,md:3,xs:12,key:t.id},r.a.createElement(Q,Object.assign({},t,{editablePrice:e.editablePrices,onPriceChange:e.onPriceChange,onActionClick:e.onActionClick,onCardClick:e.onCardClick,controls:e.controls,textStyle:t.habilitado?null:{textDecoration:"line-through"}})))})),e.showNewItem&&r.a.createElement(W.a,{item:!0,sm:4,md:3,xs:12},r.a.createElement(Q,{id:"NUEVO",imgSrc:"./add.svg",pvp_final:0,nombre:"AGREGA UN NUEVO ITEM",onCardClick:e.onCardClick}))))}var ae=a(29),ne=a(486),re=a(487),oe=a(270),ie=a(489),le=a(490),ce=a(491),se=a(455),ue=a(488),de=r.a.forwardRef((function(e,t){return r.a.createElement(se.a,Object.assign({direction:"up",ref:t},e))}));function me(e){var t=e.show,a=e.onClose,n=e.fullScreen,o=e.title,i=e.closeButtonText||"ICON";return r.a.createElement(ne.a,{maxWidth:!n&&"sm",fullWidth:!0,open:t,onClose:a,fullScreen:n,TransitionComponent:de},n?r.a.createElement(re.a,{position:"relative"},r.a.createElement(oe.a,null,r.a.createElement(y.a,{color:"inherit",variant:"h4",style:{flexGrow:1}},o),"ICON"===i?r.a.createElement(b.a,{onClick:a,type:"button",color:"inherit"},r.a.createElement(ue.a,null)):r.a.createElement(O.a,{type:"button",onClick:a,color:"inherit"},i||"SALIR"))):r.a.createElement(ie.a,{title:o}),r.a.createElement(le.a,null,e.children),e.footer&&r.a.createElement(ce.a,null,e.footer))}function pe(e){var t=e.selected?{border:"3px solid #333"}:null;return r.a.createElement(f.a,null,r.a.createElement(H.a,{onClick:e.onClick,value:e.id,style:t,component:"button"},r.a.createElement(Y.a,{style:{minHeight:150,height:"25vh"},image:e.imgSrc,title:e.nombre}),r.a.createElement(g.a,null,r.a.createElement(y.a,null,e.nombre))))}var he=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={selections:[]},e.handleClose=function(){var t=e._Item().maxItems||0;return e.state.selections.length?t<e.state.selections.length?alert("No se puede continuar selecciona "+t+" items"):void e.props.onDone({selections:e.state.selections,id:e.props.showingID}):e.props.onDone()},e.toggleSelect=function(t){var a=t.currentTarget.value,n=e._Item().maxItems||0;e.setState((function(e){var t=Object(p.a)({},e);t.selections=Object(ae.a)(t.selections);var r=t.selections.indexOf(+a);return r>=0?t.selections.splice(r,1):(t.selections.push(+a),t.selections.length>n&&t.selections.splice(0,1)),t}))},e}return Object(c.a)(a,[{key:"componentWillReceiveProps",value:function(e){null!==e.showingID&&void 0!==e.showingID||this.setState({selections:[]})}},{key:"shouldComponentUpdate",value:function(e){var t=!(null===this.props.showingID||void 0===this.props.showingID);return t!==!(null===e.showingID||void 0===e.showingID)||!1!==t}},{key:"_Item",value:function(){var e=this;return this.props.productList.find((function(t){return t.id===e.props.showingID}))||{}}},{key:"render",value:function(){var e=this,t=!(void 0===this.props.showingID||null===this.props.showingID),a=this.state.selections,n=this._Item(),o=(n.opciones||[]).map((function(e){return e.idOpcion})),i=this.props.productList.filter((function(e){return o.indexOf(e.id)>=0}));return r.a.createElement(me,{title:"Crea tu combinaci\xf3n",onClose:this.handleClose,show:t,fullScreen:!0,closeButtonText:a.length?"GUARDAR":"SALIR"},r.a.createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},r.a.createElement(y.a,{variant:"h6"},n.nombre)),r.a.createElement("div",{style:{paddingLeft:10,paddingRight:10,margin:"auto",width:"calc(100% - 20px)"}},r.a.createElement(W.a,{container:!0,spacing:3},i.map((function(t){return r.a.createElement(W.a,{key:t.id,item:!0,xs:12,sm:4},r.a.createElement(pe,Object.assign({},t,{onClick:e.toggleSelect,selected:a.indexOf(t.id)>=0})))})))))}}]),a}(r.a.Component),fe=a(453),ge=a(456);function ve(e){var t=e.items,a=e.show_next_discount,n=e.descuento,o=e.valor_envio,i=e.gran_total,l=e.total_pedido,c=e.subtotal,s=e.subtotal_con_descuento||0;n||(n={porcentaje:0,valor:0});var u=a&&n.sgte_descuento_porcentaje,d=(n.valor+t.filter((function(e){return e.idReglaRegalo})).reduce((function(e,t){return e+t.pvp_final*t.cantidad}),0)).moneyRound(),m=s&&(d/s*100).moneyRound();return r.a.createElement(fe.a,null,t.map((function(t,a){return r.a.createElement(Ee,{key:t.id+"-"+a,col1:t.cantidad,col2:(t.idReglaRegalo?"\ud83c\udf81 ":"")+t.nombre,col3:(t.pvp_final*t.cantidad).toCurrency(),componentes:e.showComponentes?t.componentes:null})})),r.a.createElement(Ee,{col1:"SUBTOTAL (NO APLICA DESCUENTOS)",col3:(c-s).toCurrency()}),r.a.createElement(Ee,{col1:"SUBTOTAL (APLICA DESCUENTOS)",col3:s.toCurrency()}),r.a.createElement(Ee,{col1:e.LabelDescuentoComponent||"TU GANANCIA (".concat(m,"%) EN ESTE PEDIDO"),col3:d.toCurrency(),color:"primary"}),u&&r.a.createElement(ge.a,null,r.a.createElement(y.a,{variant:"subtitle1",color:"secondary"},"Obt\xe9n el ".concat(n.sgte_descuento_porcentaje,"% de descuento agregando ").concat(n.sgte_descuento_falta.toCurrency()," m\xe1s a tu pedido"))),r.a.createElement(Ee,{col1:"TOTAL DEL PEDIDO",col3:l.toCurrency()}),r.a.createElement(Ee,{col1:"ENV\xcdO",col3:o.toCurrency()}),r.a.createElement(Ee,{col1:"VALOR A PAGAR",variant:"subtitle2",col3:i.toCurrency()}))}function Ee(e){var t=e.col1,a=e.col2,n=e.col3,o=e.color,i=e.variant,l=e.componentes;return r.a.createElement(ge.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("div",null,r.a.createElement("div",{style:{width:"100%",display:"table"}},r.a.createElement(y.a,{component:"div",color:o||"initial",style:{display:"table-cell",width:a?"15%":"75%",maxWidth:100,textAlign:a?"left":"right"},variant:i||"body1"},t),a&&r.a.createElement(y.a,{color:o||"initial",style:{display:"table-cell",width:"60%"},variant:i||"body1"},a),r.a.createElement(y.a,{color:o||"initial",style:{display:"table-cell",width:"25%",maxWidth:100,textAlign:"right"},variant:i||"body1"},n))),l&&l.length?r.a.createElement("div",null,l.map((function(e){return r.a.createElement(Ee,{key:e.id,col1:e.cantidad,col2:e.nombre,col3:"",variant:"body2",componentes:e.componentes})}))):null))}function be(e){for(var t={total:0,cantidad:0},a=0;a<e.length;a++){var n=e[a];t.cantidad+=n.cantidad,t.total+=n.pvp_final*n.cantidad}return t}function ye(e){return e||(e=""),"1"===e.toString()?"RUC":"2"===e.toString()?"Cedula":"3"===e.toString()?"Pasaporte":""}function Oe(e){return["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sept","Oct","Nov","Dic"][e]}var Ce=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"tel",value:function(e){if(e){if(e.length<7)return"El n\xfamero de telefono debe tener al menos 7 digitos";for(var t=0;t<e.length;t++)if(!("+"===e[t]||(a=e[t],a>="0"&&a<="9")||""===e[t].trim()))return"El n\xfamero debe tener uno de estos formatos: '09123456789' o '+5931234567890'";var a}}},{key:"email",value:function(e){if(e){if(e.length<5)return"El email no est\xe1 escrito correctamente";var t=e.split("@");return 2!==t.length?"El email no est\xe1 escrito correctamente":t[1].indexOf(".")>=0?e.trim().indexOf(" ")>=0||e.trim().indexOf("\t")>=0||e.trim().indexOf("\r")>=0?"El email no est\xe1 escrito correctamente":void 0:"El email no est\xe1 escrito correctamente"}}}]),e}();function Ae(e,t){if(e||(e=""),3!==(t=+t)){if(1===t){if(13!==e.length)return"N\xfamero de RUC debe tener 13 digitos";if(13===e.length&&"9999999999999"===e)return}return 2===t&&10!==e.length?"N\xfamero de Cedula debe tener 10 digitos":""}}function Se(e){var t=e.error,a=e.maxLength,n=Object(z.a)(e,["error","maxLength"]),o={};return t&&(o.error=!0,o.helperText=t),n.inputProps||(n.inputProps={}),n.inputProps.id=n.name,a&&(n.inputProps.maxLength=a),n.style||(n.style={margin:10,width:"calc(100% - 20px)"}),r.a.createElement(v.a,Object.assign({},o,n),e.children)}var De=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleChange=function(t){var a=t.currentTarget,n=a.name,r=a.value;e.props.onValueChange(n,r)},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.direccion,a=e.tipo_envio,n=e.ciudad,o=e.referencia,i=e.sector,l=e.visible,c=e.documento,s=e.identificacion,u=e.razonSocial,d=e.direccion_factura,m=e.telefono_factura,p=e.email_factura,h=e.nombre_contacto,f=e.telefono_contacto,g=e.identificacion_contacto,E=e.documento_contacto,b=s?Ae(s,c):"",O=Ce.tel(m),C=Ce.email(p),A=g?Ae(g,E):"",S=Ce.tel(f),D="DENTRO DE CIUDAD"!==a||null,w="PICK-UP"!==a||null;return r.a.createElement(F.a,{style:{margin:"auto",height:"100%",width:"100%",padding:10,marginTop:10,display:l?"block":"none"}},r.a.createElement(W.a,{container:!0},r.a.createElement(W.a,{item:!0,sm:6},r.a.createElement(y.a,{variant:"subtitle1",style:{marginLeft:10}},"Datos de Env\xedo"),r.a.createElement(v.a,{variant:"outlined",name:"nombre_contacto",inputProps:{id:"nombre_contacto"},value:h,onChange:this.handleChange,label:"Nombre *",multiline:!0,rows:2,style:{margin:10,width:"calc(100% - 20px)"}}),r.a.createElement(v.a,{name:"documento_contacto",value:E,inputProps:{id:"documento_contacto"},variant:"outlined",select:!0,SelectProps:{native:!0},onChange:this.handleChange,label:"Documento *",style:{margin:10,width:"calc(100% - 20px)"}},r.a.createElement("option",{value:"1"},ye("1")),r.a.createElement("option",{value:"2"},ye("2")),r.a.createElement("option",{value:"3"},ye("3"))),r.a.createElement(Se,{variant:"outlined",name:"identificacion_contacto",value:g,error:A,onChange:this.handleChange,type:"phone",maxLength:20,label:"Numero de "+ye(E)+" *"}),r.a.createElement(Se,{variant:"outlined",name:"telefono_contacto",value:f,error:S,maxLength:20,onChange:this.handleChange,label:"Telefono *",type:"phone"}),r.a.createElement(v.a,{name:"tipo_envio",value:a,inputProps:{id:"tipo_envio"},variant:"outlined",select:!0,SelectProps:{native:!0},onChange:this.handleChange,label:"Tipo de Env\xedo *",style:{margin:10,width:"calc(100% - 20px)"}},r.a.createElement("option",{value:"DENTRO DE CIUDAD"},"ENV\xcdO A QUITO"),r.a.createElement("option",{value:"ZONA CONTINENTAL"},"ENV\xcdO AL RESTO DEL PA\xcdS"),r.a.createElement("option",{value:"PICK-UP"},"RETIRO GRATIS EN OFICINA QUITO"),r.a.createElement("option",{value:"GALAPAGOS ISLA CRUZ - BALTRA"},"GALAPAGOS ISLA CRUZ - BALTRA"),r.a.createElement("option",{value:"GALAPAGOS ISLA ISABELA Y FERNANDINA"},"GALAPAGOS ISLA ISABELA Y FERNANDINA")),w&&r.a.createElement(r.a.Fragment,null,D&&r.a.createElement(v.a,{variant:"outlined",name:"ciudad",inputProps:{id:"ciudad"},value:n,onChange:this.handleChange,label:"Ciudad *",style:{margin:10,width:"calc(100% - 20px)"}}),r.a.createElement(v.a,{variant:"outlined",name:"sector",inputProps:{id:"sector"},value:i,onChange:this.handleChange,label:"Sector *",style:{margin:10,width:"calc(100% - 20px)"}}),r.a.createElement(v.a,{variant:"outlined",name:"direccion",inputProps:{id:"direccion"},value:t,onChange:this.handleChange,label:"Direccion Exacta* ",multiline:!0,rows:3,style:{margin:10,width:"calc(100% - 20px)"}}),r.a.createElement(v.a,{variant:"outlined",name:"referencia",inputProps:{id:"referencia"},value:o,onChange:this.handleChange,label:"Referencia",multiline:!0,rows:2,style:{margin:10,width:"calc(100% - 20px)"}}))),r.a.createElement(W.a,{item:!0,sm:6},r.a.createElement(y.a,{style:{marginLeft:10},variant:"subtitle1"},"Datos de Facturaci\xf3n"),r.a.createElement(v.a,{name:"documento",value:c,inputProps:{id:"documento"},variant:"outlined",select:!0,SelectProps:{native:!0},onChange:this.handleChange,label:"Documento *",style:{margin:10,width:"calc(100% - 20px)"}},r.a.createElement("option",{value:"1"},ye("1")),r.a.createElement("option",{value:"2"},ye("2")),r.a.createElement("option",{value:"3"},ye("3"))),r.a.createElement(Se,{variant:"outlined",name:"identificacion",value:s,error:b,onChange:this.handleChange,type:"phone",maxLength:20,label:"Numero de "+ye(c)+" *"}),r.a.createElement(v.a,{variant:"outlined",name:"razonSocial",value:u,onChange:this.handleChange,label:"Nombre / Empresa *",inputProps:{maxLength:200,id:"razonSocial"},style:{margin:10,width:"calc(100% - 20px)"}}),r.a.createElement(v.a,{variant:"outlined",name:"direccion_factura",value:d,onChange:this.handleChange,label:"Direccion *",inputProps:{maxLength:300,id:"direccion_factura"},multiline:!0,rows:2,style:{margin:10,width:"calc(100% - 20px)"}}),r.a.createElement(Se,{variant:"outlined",name:"telefono_factura",value:m,error:O,maxLength:20,onChange:this.handleChange,label:"Telefono *",type:"phone"}),r.a.createElement(Se,{variant:"outlined",name:"email_factura",value:p,error:C,maxLength:50,onChange:this.handleChange,label:"Email *",type:"email"}))))}}]),a}(r.a.PureComponent),we=a(271),_e=a(493),Te=a(492),xe=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).COMPONENT_ID="IMAGE_INPUT_"+(new Date).valueOf(),e.handleClick=function(t){document.getElementById(e.COMPONENT_ID).click()},e.handleChange=function(t){var a=t.currentTarget.files;e.props.onChange(a&&a.length&&a[0]||null)},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.src,a=e.title,n=e.className,o=e.loading,i=e.disabled,l=e.onDelete;return r.a.createElement(f.a,null,l&&r.a.createElement("div",{style:{textAlign:"right"}},r.a.createElement(b.a,{onClick:l},r.a.createElement(ue.a,null))),r.a.createElement(H.a,{disabled:i,onClick:this.handleClick,style:{textAlign:"center"},type:"button"},r.a.createElement("input",{hidden:!0,type:"file",onChange:this.handleChange,accept:"image/*",id:this.COMPONENT_ID}),t?r.a.createElement(Y.a,{component:"img",className:n,title:a||"Imagen",image:t}):r.a.createElement("div",{className:n,style:{display:"table",textAlign:"center",margin:"auto"}},r.a.createElement("div",{style:{display:"table-cell",verticalAlign:"middle"}},o?r.a.createElement(y.a,{variant:"h3"},"CARGANDO..."):r.a.createElement(r.a.Fragment,null,r.a.createElement(Te.a,null),r.a.createElement(y.a,null,"Aplasta aqu\xed para subir una imagen"))))))}}]),a}(r.a.PureComponent),ke=function(e){var t=r.a.useState(!1),a=Object(B.a)(t,2),n=a[0];a[1];return r.a.createElement(F.a,{style:{maxWidth:400,padding:10,marginTop:10,height:"100%",marginLeft:"auto",marginRight:"auto",display:e.visible?"block":"none"}},r.a.createElement("form",{onSubmit:e.onDone,style:{textAlign:"center"}},r.a.createElement(y.a,{style:{marginTop:10,marginBottom:10,textAlign:"center"},variant:"h6"},"Total a Pagar : ",(e.total_pagar-(n?12:0)).toCurrency()),r.a.createElement(C.a,null),r.a.createElement("div",{style:{padding:20,paddingBottom:0}},r.a.createElement(y.a,{variant:"h6"},"Realiza tu pago mediante Transferencia o Deposito Bancario a la cuenta:"),r.a.createElement(y.a,null,"BANCO PICHINCHA Cta. Ahorros #2205511631"),r.a.createElement(y.a,null,"RUC. 1792627192001"),r.a.createElement(y.a,null,"COSMETICOSNATU CIA LTDA"),r.a.createElement(y.a,null,"pagos@natucosmetic.com"),r.a.createElement("div",{style:{marginTop:10}},r.a.createElement(y.a,{variant:"h6"},"O realiza tu pago con tarjeta de cr\xe9dito:"),r.a.createElement("table",{cellPadding:"10",cellSpacing:"0",style:{textAlign:"center",border:0,margin:"auto",padding:0}},r.a.createElement("tr",null,r.a.createElement("td",{align:"center",style:{padding:0}},r.a.createElement("a",{href:"https://www.paypal.me/natucosmeticoficial",target:"_blank",title:"Paga con paypal aqui"},r.a.createElement("img",{src:"https://www.paypalobjects.com/webstatic/mktg/logo/AM_mc_vs_dc_ae.jpg",alt:"PayPal Acceptance Mark"}))))))),null,null,e.usarImagen&&r.a.createElement(je,{items:e.imgTransaccionList,onImgChange:e.onImgChange,onImgDelete:e.onImgDelete}),r.a.createElement(O.a,{type:"submit",disabled:e.loading,variant:"outlined",color:"primary",style:{margin:10,width:"calc(100% - 20px)"}},e.loading?r.a.createElement(V.a,{size:25}):"ENVIAR")))};function je(e){var t=e.items;return r.a.createElement(r.a.Fragment,null,t.map((function(t,a){return r.a.createElement(xe,{key:a,loading:t.isLoading,disabled:e.loading,className:"transaction-img",onChange:function(t){return e.onImgChange(t,a)},onDelete:function(){return e.onImgDelete(a)},src:t.src})})),r.a.createElement(xe,{loading:!1,disabled:e.loading,className:"transaction-img",onChange:function(t){return e.onImgChange(t)},src:""}))}var Ie=Object(d.g)(function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={txt1:"",txt2:"",loading:!1,id:""},n.handleClose=n.handleClose.bind(Object(P.a)(n)),n.handleChange=n.handleChange.bind(Object(P.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(P.a)(n)),n.state.id=e.match.params.id,n}return Object(c.a)(a,[{key:"handleChange",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(Object(h.a)({},a,n))}},{key:"unblock",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.unblock=this.props.history.block=function(){return e.state.loading?"Espera un momento, tu informaci\xf3n se est\xe1 guardando":null}}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.txt1,r=a.txt2,o=a.loading,i=a.id;if(!o){if(!n&&!r)return this.props.history.goBack();this.setState({loading:!0}),S.ActionOrder(i,{action:"SURVEY",value:[n,r]}).then((function(e){t.setState({loading:!1}),t.props.history.goBack()})).catch((function(e){t.setState({loading:!1}),alert(e.message)}))}}},{key:"handleClose",value:function(){this.state.loading||this.props.history.goBack()}},{key:"render",value:function(){var e=this.props,t=this.state,a=t.txt1,n=t.txt2,o=t.loading;return r.a.createElement(ne.a,{open:!0,onClose:this.handleClose},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(le.a,null,r.a.createElement(y.a,{style:{textAlign:"center"},variant:"h6"},e.title),r.a.createElement(y.a,{style:{marginTop:10},variant:"subtitle1"},"C\xf3mo podemos ayudarte a mejorar tus ventas?"),r.a.createElement(v.a,{autoFocus:!0,name:"txt1",multiline:!0,rows:2,label:"Escribe tu respuesta",value:a,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(y.a,{style:{marginTop:10},variant:"subtitle1"},"Comp\xe1rtenos alguna experiencia que hayan tenido tus clientes usando nuestros productos"),r.a.createElement(v.a,{name:"txt2",multiline:!0,rows:3,label:"Escribe tu respuesta",value:n,onChange:this.handleChange,fullWidth:!0})),r.a.createElement(ce.a,null,r.a.createElement(O.a,{type:"submit",variant:"outlined"},o?r.a.createElement(V.a,{size:25}):"GUARDAR"))))}}]),a}(r.a.Component));function Pe(e){var t=e.title,a=e.message,n=e.info,o=e.onClose;return r.a.createElement(ne.a,{open:Boolean(a)||Boolean(e.children),onClose:o},r.a.createElement(ie.a,null,t),r.a.createElement(le.a,{style:{textAlign:"center"}},e.children||r.a.createElement("div",null,r.a.createElement(y.a,{variant:"subtitle1"},a),r.a.createElement(y.a,{variant:"body1"},n))),r.a.createElement(ce.a,null,r.a.createElement(O.a,{type:"button",onClick:e.onClose},"SALIR")))}var Re=Object(d.g)(function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).unblock=function(){return null},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=new URLSearchParams(this.props.location.search).get("focusafter");e&&(this.unblock=this.props.history.block((function(t){setTimeout((function(){window.requestAnimationFrame((function(){try{document.getElementById(e).focus()}catch(t){}}))}),100)})))}},{key:"componentWillUnmount",value:function(){this.unblock&&this.unblock()}},{key:"render",value:function(){var e=this,t=new URLSearchParams(this.props.location.search);return r.a.createElement(Pe,{title:t.get("a"),message:t.get("b"),onClose:function(t){return e.props.history.goBack()}})}}]),a}(r.a.PureComponent)),Ne=a(499),Le=a(272),Ue=a(494),Me=a(495);function Fe(e){var t=e.id,a=e.productList,n=e.selections,o=!(void 0===t||null===t),i=a.find((function(e){return e.id===+t}))||{},l=(n||{})[t]||[];function c(a){var n=+a.currentTarget.value;null===n||void 0===n||isNaN(n)||e.onDeleteSelection({id:t,index:n})}return r.a.createElement(me,{title:"Elimina una combinaci\xf3n",onClose:e.onDeleteSelection,show:o,fullScreen:!0},r.a.createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},r.a.createElement(y.a,{variant:"h6"},i.nombre)),r.a.createElement("div",{style:{paddingLeft:10,paddingRight:10,margin:"auto",width:"calc(100% - 20px)"}},r.a.createElement(fe.a,null,l.map((function(e,t){return r.a.createElement(ge.a,null,r.a.createElement(Le.a,null,e.map((function(e){return r.a.createElement(y.a,null,(a.find((function(t){return t.id===e}))||{nombre:"id ".concat(e," - Not Found")}).nombre)}))),r.a.createElement(Ue.a,null,r.a.createElement(b.a,{onClick:c,value:t},r.a.createElement(Me.a,null))))})))))}var Ge=a(172),Be=a(57),Ve=Object(Be.b)("Order/FetchData",(function(){return Promise.all([S.GetProducts(),S.GetGiftRules()])})),We=a(169),ze=function e(){Object(l.a)(this,e),this.productList=[],this.productoSelecciones={},this.descuentoAplica=null,this.subtotal=0,this.tipo_envio="PICK-UP",this.direccion="",this.sector="",this.ciudad="",this.referencia="",this.documento="1",this.razonSocial="",this.identificacion="",this.telefono_factura="",this.direccion_factura="",this.email_factura="",this.documento_contacto="2",this.identificacion_contacto="",this.nombre_contacto="",this.telefono_contacto="",this.observacion="",this.numeroTransaccion="",this.imgTransaccionList=[],this.usarImagen=!0},He=function(){try{var e=new ze,t={},a=[],n=x.Get("direccion")||{};for(var r in n)e.hasOwnProperty(r)&&n[r]&&(t[r]=n[r]);var o=x.Get("factura")||{};for(var i in o)e.hasOwnProperty(i)&&o[i]&&(t[i]=o[i]);var l=x.Get("current_order")||{};for(var c in l)e.hasOwnProperty(c)&&(t[c]=l[c]);l&&l.choosen&&l.choosen.length&&(a=l.choosen)}catch(s){}return[t,a]},qe=function(e){return new Promise((function(t,a){if(e.size>15728640){var n=(e.size/1024/1024).toFixed(2);return a({message:"Tu imagen (".concat(n," Mb) es muy pesada, selecciona otra m\xe1ximo de 15 Mb")})}setTimeout((function(n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=a,r.readAsDataURL(e)}),100)}))};function Ye(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(a){t({base64:Ke(a.target.result),ext:e.type.split("/")[1]})},n.onerror=a,n.readAsArrayBuffer(e)}))}function Ke(e){for(var t,a="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),o=r.byteLength,i=o%3,l=o-i,c=0;c<l;c+=3)a+=n[(16515072&(t=r[c]<<16|r[c+1]<<8|r[c+2]))>>18]+n[(258048&t)>>12]+n[(4032&t)>>6]+n[63&t];return 1===i?a+=n[(252&(t=r[l]))>>2]+n[(3&t)<<4]+"==":2===i&&(a+=n[(64512&(t=r[l]<<8|r[l+1]))>>10]+n[(1008&t)>>4]+n[(15&t)<<2]+"="),a}var Ze=document.getElementById("loading-full-message"),Je=Object(Be.b)("Image/LoadImage",(function(e){var t=e.reportError,a=e.imgFile,n=e.index;return new Promise((function(e){if(Ze.style.display="none",window.requestAnimationFrame)return window.requestAnimationFrame((function(){return e(void 0)}));e(void 0)})).then((function(){return qe(a).then((function(e){return Ze.style.display="none",{imgUrl:e,imgFile:a,index:n}})).catch((function(e){throw Ze.style.display="none",t(e.message),e}))}))})),Xe=Object(Be.b)("pedido/LocalStoreOrder",(function(e,t){if(e.clean)return e.reportCompleted&&e.reportCompleted(),Promise.resolve(x.Set("current_order"));var a=t.getState().Order.data,n=a.productList.filter((function(e){return e.cantidad})).map((function(e){return{id:e.id,cantidad:e.cantidad}})),r=a.numeroTransaccion,o=a.observacion,i=a.direccion,l=a.ciudad,c=a.sector,s=a.referencia,u=a.documento,d=a.identificacion,m=a.razonSocial,p=a.telefono_factura,h=a.direccion_factura,f=a.email_factura,g=a.tipo_envio,v=a.documento_contacto,E=a.identificacion_contacto,b=a.nombre_contacto,y=a.telefono_contacto,O=a.productoSelecciones;return x.Set("current_order",{numeroTransaccion:r,direccion:i,ciudad:l,choosen:n,sector:c,observacion:o,referencia:s,documento:u,identificacion:d,razonSocial:m,telefono_factura:p,direccion_factura:h,email_factura:f,tipo_envio:g,documento_contacto:v,identificacion_contacto:E,nombre_contacto:b,telefono_contacto:y,productoSelecciones:O}),e.reportCompleted&&e.reportCompleted(),Promise.resolve()})),Qe=a(206),$e=a.n(Qe),et=a(305);function tt(e){return null===e||(void 0===e||(""===e||!e.toString().length))}function at(e){var t=e.numeroTransaccion,a=e.ciudad,n=e.sector,r=e.direccion,o=e.tipo_envio,i=e.documento,l=e.identificacion,c=e.razonSocial,s=e.telefono_factura,u=e.direccion_factura,d=e.documento_contacto,m=e.identificacion_contacto,p=e.nombre_contacto,h=e.telefono_contacto,f=e.email_factura,g=e.usarImagen,v=e.imgTransaccionList,E={};if(!e.detalle.length)return{productList:"Debes elegir por lo menos un producto"};if(tt(o)&&(E.tipo_envio="Selecciona el tipo de env\xedo"),["PICK-UP","DENTRO DE CIUDAD"].indexOf(o)<0&&tt(a)&&(E.ciudad="Digita la ciudad"),"PICK-UP"!==o&&tt(n)&&(E.sector="Digita el sector"),"PICK-UP"!==o&&tt(r)&&(E.direccion="Digita la direccion"),tt(d)&&(E.documento_contacto="Selecciona el documento de identificaci\xf3n de la persona que recibe"),tt(m))E.identificacion_contacto="Digita el n\xfamero de "+ye(d)+" de la persona que recibe";else{var b=Ae(m,d);b&&(E.identificacion_contacto="La identificaci\xf3n de la persona que recibe es incorrecta: "+b)}if(tt(p)&&(E.nombre_contacto="Digita el nombre de la persona que recibe"),tt(h))E.telefono_contacto="Digita el numero de Telefono de la persona que recibe";else{var y=Ce.tel(h);y&&(E.telefono_contacto="Telefono de persona que recibe inv\xe1lido: "+y)}if(tt(i)&&(E.documento="Selecciona un documento de identificaci\xf3n"),tt(l))E.identificacion="Digita el n\xfamero de "+ye(i)+" de facturaci\xf3n";else{var O=Ae(l,i);O&&(E.identificacion="La identificaci\xf3n de facturaci\xf3n est\xe1 incorrecta: "+O)}if(tt(c)&&(E.razonSocial="Digita la Razon Social de la factura"),tt(s))E.telefono_factura="Digita el n\xfamero de Telefono de facturaci\xf3n";else{var C=Ce.tel(s);C&&(E.telefono_factura="Telefono de facturaci\xf3n inv\xe1lido: "+C)}if(tt(u)&&(E.direccion_factura="Digita la direcci\xf3n de facturaci\xf3n"),tt(f)&&(E.email_factura="Digita el email de facturaci\xf3n"),tt(f))E.email_factura="Digita el email de facturaci\xf3n";else{var A=Ce.email(f);A&&(E.email_factura=A)}return g?v&&v.length||(E.imgTransaccionList="Agrega la imagen del comprobante de pago"):tt(t)&&(E.numeroTransaccion="Digita el numero de comprobante de pago"),Object.keys(E).length?E:null}var nt=Object(Be.b)("Order/SaveOrderIntoAPI",function(){var e=Object(et.a)($e.a.mark((function e(t){var a,n,r,o,i,l,c,s,u,d,m,h,f,g,v,E,b,y,O,C,A,D,w,_,T,k,j,I,P,R,N,L;return $e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.order,n=t.reportError,r=t.reportCompleted,e.prev=1,!(o=at(a))){e.next=11;break}if(!o.productList){e.next=6;break}throw{message:o.productList,name:"ProductsValidationError"};case 6:if(!(i=Object.keys(o)).length){e.next=11;break}if(!(["ciudad","referencia","direccion","sector","tipo_envio","identificacion","documento","razonSocial","tipo_envio","direccion_factura","telefono_factura","email_factura","identificacion_contacto","nombre_contacto","telefono_contacto"].indexOf(i[0])>=0)){e.next=10;break}throw{message:o[i[0]],propertyName:i[0],name:"OrderDataValidationError"};case 10:throw{message:o[i[0]],propertyName:i[0],name:"OrderValidationError"};case 11:if(l=a.observacion,c=a.tipo_envio,s=a.documento_contacto,u=a.identificacion_contacto,d=a.nombre_contacto,m=a.telefono_contacto,h=a.documento,f=a.identificacion,g=a.razonSocial,v=a.telefono_factura,E=a.direccion_factura,b=a.email_factura,y=a.descuentoAplica,O=a.usarImagen,C=a.productoSelecciones,A=a.imgTransaccionList,D=a.subtotal,w=a.envio,_=a.total,T=a.ciudad,k=a.sector,j=a.direccion,I=a.referencia,"PICK-UP"===c&&(T="",k="",j="",I=""),"DENTRO DE CIUDAD"===c&&(T="QUITO"),!O){e.next=21;break}return e.next=18,Promise.all(A.map((function(e){return Ye(e.file)})));case 18:P=e.sent,e.next=22;break;case 21:R=a.numeroTransaccion;case 22:return e.next=24,S.SaveOrder({ciudad:T,sector:k,direccion:j,observacion:l,referencia:I,tipo_envio:c,documento_contacto:s,identificacion_contacto:u,nombre_contacto:d,telefono_contacto:m,documento:h,identificacion:f,razonSocial:g,telefono_factura:v,direccion_factura:E,email_factura:b,detalle:a.detalle.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{idProducto:e.id,cantidad:e.cantidad,descuentoPorcentaje:e.idReglaRegalo?100:e.aplica_descuento?y&&y.porcentaje:0,descuentoTotal:e.idReglaRegalo?e.cantidad*e.pvp_final:0})})).map((function(e){return delete e.id,e.descuentoPorcentaje&&!e.descuentoTotal&&(e.descuentoTotal=e.cantidad*e.pvp_final*e.descuentoPorcentaje/100,e.descuentoTotal=e.descuentoTotal.moneyRound()),e})),numeroTransaccion:R,filesTransaccion:P,subtotal:D,envio:w,regaloTotal:a.detalle.reduce((function(e,t){return e+(t.idReglaRegalo?t.pvp_final*t.cantidad:0)}),0).moneyRound(),baseIva:0,iva:0,total:_,descuentoPorcentaje:y&&y.porcentaje,descuentoTotal:y&&y.valor,productoSelecciones:C});case 24:return N=e.sent,L=N.id,x.Set("current_order"),x.Set("direccion",{direccion:j,ciudad:T,sector:k,referencia:I,tipo_envio:c,documento_contacto:s,identificacion_contacto:u,nombre_contacto:d,telefono_contacto:m}),x.Set("factura",{identificacion:f,documento:h,razonSocial:g,telefono_factura:v,direccion_factura:E,email_factura:b}),r(L),e.abrupt("return",L);case 33:throw e.prev=33,e.t0=e.catch(1),n(e.t0),e.t0;case 37:case"end":return e.stop()}}),e,null,[[1,33]])})));return function(t){return e.apply(this,arguments)}}()),rt=Object(Be.c)({name:"Order",reducers:{updateCurrentTab:function(e,t){"save-order:loading"!==e.status&&(e.currentTab=t.payload)},changeProductQuantity:function(e,t){ot(e,t.payload.Id,t.payload.type),e.isDirty=!0},changeDataValue:function(e,t){var a=t.payload,n=a.name,r=a.value;e.data[n]=r,e.isDirty=!0},changeProductPrice:function(e,t){var a=t.payload,n=a.pvp_final,r=a.id,o=e.data.productList.find((function(e){return e.id===r}));o&&(o.pvp_final=n),e.isDirty=!0},addProductSelection:function(e,t){var a=t.payload,n=a.id,r=a.selections;e.data.productoSelecciones.hasOwnProperty(n)||(e.data.productoSelecciones[n]=[]),e.data.productoSelecciones[n].push(r),e.isDirty=!0},removeProductSelection:function(e,t){var a=t.payload,n=a.id,r=a.index;e.data.productoSelecciones.hasOwnProperty(n)&&(e.data.productoSelecciones[n][r]&&e.data.productoSelecciones[n].splice(r,1));e.isDirty=!0},deleteImgTransaccion:function(e,t){var a=t.payload;e.data.imgTransaccionList[a]&&e.data.imgTransaccionList.splice(a,1)}},extraReducers:function(e){e.addCase(Ve.pending,(function(e){e.status="fetch-data:loading"})).addCase(Ve.rejected,(function(e,t){e.status="fetch-data:error",e.error=t.error.message})).addCase(Ve.fulfilled,(function(e,t){var a=Object(B.a)(t.payload,2),n=a[0],r=a[1];e.status="fetch-data:completed",e.data.productList=n.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{cantidad:0})})),e.giftRules=r;var o=He(),i=Object(B.a)(o,2),l=i[0],c=i[1];Object.assign(e.data,l);var s,u=Object(We.a)(c);try{for(u.s();!(s=u.n()).done;)for(var d=s.value,m=0;m<d.cantidad;m++)ot(e,d.id,"+")}catch(h){u.e(h)}finally{u.f()}})).addCase(Je.pending,(function(e){e.status="image:loading"})).addCase(Je.fulfilled,(function(e,t){e.status="image:completed";var a={src:t.payload.imgUrl,file:t.payload.imgFile},n=t.payload.index;e.data.imgTransaccionList[n]?e.data.imgTransaccionList[n]=a:e.data.imgTransaccionList.push(a),e.isDirty=!0})).addCase(Je.rejected,(function(e,t){e.status="image:error",e.error=t.error.message})).addCase(Xe.fulfilled,(function(e){e.isDirty=!1})).addCase(nt.pending,(function(e){e.status="save-order:loading"})).addCase(nt.rejected,(function(e,t){e.status="save-order:error",e.error=t.error.message,"OrderDataValidationError"===t.error.name&&(e.currentTab="OrderData"),"ProductsValidationError"===t.error.name&&(e.currentTab="ProductList")})).addCase(nt.fulfilled,(function(e){e.isDirty=!1,e.status="save-order:completed";var t=He(),a=Object(B.a)(t,1)[0];e.data=Object.assign({},new ze,a,{productList:e.data.productList.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{cantidad:0})}))}),e.currentTab="ProductList"}))},initialState:{currentTab:"ProductList",isDirty:!1,status:"",error:void 0,data:Object.assign({},new ze),giftRules:[]}});function ot(e,t,a){var n=e.data.productList.find((function(e){return e.id===t}));if(n){var r=n.cantidad&&!isNaN(+n.cantidad)?n.cantidad:0;"+"===a&&(n.cantidad_desde&&r<=0?n.cantidad=n.cantidad_desde:n.cantidad=+r+1),"-"===a&&(n.cantidad_desde&&r<=n.cantidad_desde?n.cantidad=0:n.cantidad=+r-1)}}var it=rt.reducer,lt=rt.actions,ct=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"ApplyRules",value:function(e,t){var a,n=[],r=Object(We.a)(e);try{var o=function(){var e=a.value;if(e.condiciones.filter((function(e){return new Function("var pedido= arguments[0]; return ".concat(e.propName," ").concat(e.operator," ").concat(e.value,";"))(t)})).length!==e.condiciones.length)return"continue";n.push.apply(n,Object(ae.a)(e.regalos.map((function(t){return{id:t.id,nombre:t.nombre,imgSrc:"",pvp_final:t.pvp_final,aplica_comision:!1,aplica_descuento:!1,cantidad:t.cantidad,idReglaRegalo:e.id}}))))};for(r.s();!(a=r.n()).done;)o()}catch(i){r.e(i)}finally{r.f()}return n}}]),e}();var st=Object(d.g)(function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).guardarBorrador=function(e){n.props.isDirty&&n.props.setStoredOrder({reportCompleted:function(){return n.message("Tu pedido fue guardado como borrador","Listo!")}})},n.handleDone=function(e){e.preventDefault(),n.props.async_status.indexOf(":loading")>=0||n.props.saveOrder({order:n.props.order,reportCompleted:function(e){n.props.history.push(n.props.match.path+"/survey/"+e)},reportError:function(e){n.message(e.message,void 0,e.propertyName)}})},n.message=function(e,t,a){var r=new URLSearchParams;r.set("a",t||"Ocurri\xf3 un problem"),r.set("b",e),a&&r.set("focusafter",a),n.props.history.push(n.props.match.path+"/msg?"+r.toString())},n.handleProductAction=function(e){var t=e.currentTarget,a=t.name,r=t.value,o=n.props.order.productList.find((function(e){return e.id===+r}));if(o&&o.opciones&&o.opciones.length)return n.props.history.push(n.props.match.path+"/select-product-options/"+o.id);n.props.changeProductQuantity({Id:+r,type:a})},n.handleValueChange=function(e,t){n.props.changeDataValue({name:e,value:t})},n.imageChange=function(e,t){e&&n.props.loadTransaccionImg({imgFile:e,index:t,reportError:n.message})},n.imageDelete=function(e){e<0||n.props.deleteImgTransaccion(e)},n.handleAddSelection=function(e){e&&n.props.addProductSelection(e),n.props.history.push(n.props.match.path)},n.handleDeleteSelection=function(e){e&&n.props.removeProductSelection(e),n.props.history.push(n.props.match.path)},n.handlePriceChange=function(e){var t=+e.currentTarget.name,a=e.currentTarget.value;n.props.changeProductPrice({id:t,pvp_final:a})},e.onMounted&&e.onMounted(e.match.path),n}return Object(c.a)(a,[{key:"unblockNavigation",value:function(){}}]),Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.onbeforeunload=function(t){return e.props.isDirty?"Tu pedido a\xfan est\xe1 incompleto, deseas salir sin guardarlo?":null},this.unblockNavigation=this.props.history.block(this.routerWillLeave.bind(this)),this.props.fetchInitialData()}},{key:"componentWillUnmount",value:function(){this.props.updateCurrentTab("ProductList"),this.unblockNavigation&&this.unblockNavigation(),window.onbeforeunload&&(window.onbeforeunload=void 0)}},{key:"routerWillLeave",value:function(e){e&&0===e.pathname.indexOf(this.props.match.path)||this.props.isDirty&&(window.confirm("Tu pedido est\xe1 incompleto, quieres guardarlo para completarlo despu\xe9s?")?this.props.setStoredOrder({}):this.props.setStoredOrder({clean:!0}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.currentTab,n=t.order,o=t.async_status,i=t.tablaDescuentos,l=o.indexOf(":loading")>=0;return r.a.createElement("div",{style:{width:"100%",height:"calc(100% - 1px)",display:"flex",flexDirection:"column",padding:10,overflow:"hidden"}},r.a.createElement(U.a,{variant:"fullWidth",onChange:function(t,a){return e.props.updateCurrentTab(a)},value:a},r.a.createElement(M.a,{value:"ProductList",label:"Productos"}),r.a.createElement(M.a,{value:"OrderData",label:"Datos"}),r.a.createElement(M.a,{value:"ConfirmOrder",label:"Pedido"}),r.a.createElement(M.a,{value:"OrderPayment",label:"Pago"})),r.a.createElement(dt,{if:"ProductList"!==a},r.a.createElement(te,{visible:!0,controls:"ADD-REMOVE",onActionClick:this.handleProductAction,items:n.productList,editablePrices:this.props.editablePrices,onPriceChange:this.handlePriceChange,async_status:this.props.async_status,async_error:(this.props.async_status||"").indexOf("products")>=0?this.props.async_error:void 0})),r.a.createElement(dt,{if:"OrderData"!==a},r.a.createElement(De,Object.assign({visible:!0},n,{onValueChange:this.handleValueChange}))),"ConfirmOrder"===a&&r.a.createElement(F.a,{style:{textAlign:"center",padding:10,margin:"auto",marginTop:10,width:"100%",maxWidth:500,height:"100%"}},r.a.createElement(y.a,{variant:"h5"},"TU PEDIDO"),r.a.createElement(ve,{show_next_discount:!0,items:n.detalle,descuento:n.descuentoAplica,valor_envio:n.envio,gran_total:n.total,total_pedido:n.total_pedido,subtotal:n.subtotal,subtotal_con_descuento:n.subtotal_aplicable_descuento,LabelDescuentoComponent:3===this.props.rol?r.a.createElement(v.a,{onChange:function(t){return e.handleValueChange("descuentoAplica",i.find((function(e){return e.id===+t.currentTarget.value})))},value:n.descuentoAplica&&n.descuentoAplica.id||"",SelectProps:{native:!0},select:!0},r.a.createElement("option",null,"- SELECCIONA UN DESCUENTO -"),i.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},"DESCUENTO ",e.porcentaje,"%")}))):null}),r.a.createElement(v.a,{variant:"outlined",value:n.observacion,name:"observacion",onChange:function(t){return e.handleValueChange(t.currentTarget.name,t.currentTarget.value)},style:{width:"calc(100% - 20px)",margin:10},label:"Observacion",multiline:!0,rows:"2",inputProps:{maxLength:300,id:"observacion"}})),"OrderPayment"===a&&r.a.createElement(ke,{visible:!0,loading:l,total_pagar:n.total,onDone:this.handleDone,items:n.detalle,numeroTransaccion:n.numeroTransaccion,imgTransaccionList:n.imgTransaccionList,onImgChange:this.imageChange,onImgDelete:this.imageDelete,usarImagen:n.usarImagen,onValueChange:this.handleValueChange}),r.a.createElement(d.b,{path:this.props.match.path+"/msg",component:Re}),r.a.createElement(d.b,{path:this.props.match.path+"/survey/:id",component:Ie}),r.a.createElement(d.b,{path:this.props.match.path+"/select-product-options/:id",children:function(t){var a=t.match;return r.a.createElement(he,{showingID:a&&+a.params.id,onDone:e.handleAddSelection,productList:n.productList})}}),r.a.createElement(d.b,{path:this.props.match.path+"/view-product-options/:id",children:function(t){var a=t.match;return r.a.createElement(Fe,{id:a&&a.params.id,onDeleteSelection:e.handleDeleteSelection,productList:n.productList,selections:n.productoSelecciones})}}),r.a.createElement(G.a,{title:"Guardar Borrador",onClick:this.guardarBorrador,variant:"extended",style:{position:"fixed",bottom:20,right:20},color:"primary"},r.a.createElement(Ne.a,null)))}}]),a}(r.a.PureComponent)),ut=Object(Ge.b)((function(e,t){var a,n=e.Order,r=3===t.rol,o=(t.descuentos||[]).map((function(e,t){return Object(p.a)(Object(p.a)({},e),{},{id:e.id||t})})),i=Object(ae.a)(n.data.productList).sort((function(e,t){return e.orden-t.orden})).map((function(e){if(e.opciones&&e.opciones.length){e=Object(p.a)(Object(p.a)({},e),{},{cantidad:0});var t=n.data.productoSelecciones[e.id];t&&(e.cantidad=t.length)}return e})),l=Object(ae.a)(i.filter((function(e){return e.cantidad}))),c=be(l).total,s=be(l.filter((function(e){return e.aplica_descuento}))).total;if(r){if(n.data.descuentoAplica)var u=Object(p.a)(Object(p.a)({},n.data.descuentoAplica),{},{valor:(n.data.descuentoAplica.porcentaje*s/100).moneyRound()})}else u=function(e,t){for(var a=t.sort((function(e,t){return t.montoDesde-e.montoDesde})),n=-1,r={porcentaje:0,valor:0,sgte_descuento_porcentaje:0,sgte_descuento_falta:0,id:void 0},o=0;o<a.length;o++){if(e>=a[o].montoDesde){n=o;break}}if(n>=0){var i=a[n];r.porcentaje=i.porcentaje,r.valor=e*i.porcentaje/100,r.id=i.id}if(-1===n&&(n=a.length),n-1>=0){var l=a[n-1];l&&(r.sgte_descuento_falta=l.montoDesde-e,r.sgte_descuento_porcentaje=l.porcentaje)}return r}(s,o);var d=c-(u&&u.valor||0),m=function(e,t){if(e>=60&&t.indexOf("GALAPAGOS")<0)return 0;if("PICK-UP"===t)return 0;if("DENTRO DE CIUDAD"===t)return 3;if("ZONA CONTINENTAL"===t)return 5;if("GALAPAGOS ISLA CRUZ - BALTRA"===t)return 10;if("GALAPAGOS ISLA ISABELA Y FERNANDINA"===t)return 14}(c,n.data.tipo_envio),h=(d+m).moneyRound(),f=Object(p.a)(Object(p.a)({},n.data),{},{descuentoAplica:u,detalle:l,productList:i,subtotal:c,subtotal_aplicable_descuento:s,total_pedido:d,envio:m,total:h}),g=(new ct).ApplyRules(e.Order.giftRules,f);(a=f.detalle).push.apply(a,Object(ae.a)(g));var v=g.reduce((function(e,t){return e+t.cantidad*t.pvp_final}),0);return f.subtotal=(v+f.subtotal).moneyRound(),f.subtotal_aplicable_descuento=(v+f.subtotal_aplicable_descuento).moneyRound(),{order:f,isDirty:n.isDirty,tablaDescuentos:o,currentTab:n.currentTab,async_status:n.status,async_error:n.error}}),Object(p.a)(Object(p.a)({},lt),{},{fetchInitialData:Ve,loadTransaccionImg:Je,setStoredOrder:Xe,saveOrder:nt}))(st);function dt(e){return e.if?null:r.a.createElement(r.a.Fragment,null,e.children)}function mt(e){window.requestAnimationFrame((function(){try{document.getElementById(e).focus()}catch(t){console.error("Focus(".concat(e,") error"),t)}}))}var pt=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"Aprobar",value:function(e){var t=e._pagos;if(!t||!t.length)return alert("Necesitas registrar al menos un pago.");for(var a=0;a<t.length;a++)if(!ht(t[a],a))return;return window.confirm("Esta seguro de APROBAR este pedido?")?S.ActionOrder(e.id,{action:"APROBAR",value:t}):void 0}},{key:"Rechazar",value:function(e){if(window.confirm("Esta seguro de RECHAZAR este pedido?")){var t=window.prompt("Digita el Motivo de Rechazo");if(t)return S.ActionOrder(e.id,{action:"RECHAZAR",value:t})}}},{key:"Enviar",value:function(e){var t=e._fechaEnvio,a=e._envioImgFile,n=e._envioImgSrcStatus;if(!t||!t.toString().trim().length||isNaN(+new Date(t)))return alert("Agregue una fecha de env\xedo v\xe1lida"),mt("_fechaEnvio");if(n)return alert("No puede continuar, la imagen se est\xe1 procesando");if(window.confirm("Esta seguro de seleccionar este pedido como ENVIADO?")){var r=new Date(+t.split("-")[0],+t.split("-")[1]-1,+t.split("-")[2]),o=Promise.resolve();return a&&(o=Ye(a)),o.then((function(t){return S.ActionOrder(e.id,{action:"ENVIAR",value:r,imgFile:t})}))}}},{key:"Facturar",value:function(e){return e.numeroFactura&&e.numeroFactura.toString().trim().length?window.confirm("Esta seguro de FACTURAR este pedido?")?S.ActionOrder(e.id,{action:"FACTURAR",value:e.numeroFactura}):void 0:(alert("Agregue el n\xfamero de factura"),mt("numeroFactura"))}}]),e}();function ht(e,t){return tt(e.metodoPago)?(alert("Selecciona el metodo de pago"),mt("pago#"+t+".metodoPago")):tt(e.numeroTransaccion)?(alert("Digita el n\xfamero de transaccion"),mt("pago#"+t+".numeroTransaccion")):!tt(e.monto)||(alert("Digita el monto recibido"),mt("pago#"+t+".monto"))}function ft(e){var t={marginTop:12,marginBottom:5};return e.center&&(t.textAlign="center"),r.a.createElement("div",{style:t},r.a.createElement(y.a,{variant:"h6"},e.children),r.a.createElement(C.a,null))}function gt(e){var t=e.value,a=e.label;return r.a.createElement("div",{style:{width:"100%",textAlign:"left"}},r.a.createElement("div",{style:{width:120,display:"inline-block"}},r.a.createElement(y.a,{variant:"body1"},a)),r.a.createElement(y.a,{variant:"body2",style:{width:"auto",display:"inline"}},t))}function vt(e){var t=window.open("","_blank"),a=t.document.createElement("img");a.src=e,t.document.body.appendChild(a),t.document.body.style.textAlign="center",t.document.body.style.margin="auto"}var Et=function(e){var t=e.numeroTransaccion,a=e.imgTransaccion,n=e.pagos,o=a.indexOf(",")>=0?a.split(","):[a];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ft,null,"PAGO SUBIDO:"),t&&r.a.createElement(gt,{value:t,label:"Comprobante"}),o.map((function(e){return r.a.createElement(Y.a,{component:"img",style:{height:"auto",width:"calc(100% - 20px)",objectFit:"contain",border:"1px solid black",margin:10},image:e,title:"Comprobante",onClick:function(){return vt(e)}})})),n&&n.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,"PAGOS VERIFICADOS:"),r.a.createElement(fe.a,{style:{maxWidth:300}},n.map((function(e){return r.a.createElement(ge.a,{key:e.id},r.a.createElement(Le.a,null,e.metodoPago," ",parseFloat(e.monto).toCurrency()),r.a.createElement(Ue.a,null,"# ",e.numeroTransaccion))})))):null)},bt=a(500),yt=function(e){var t=e.metodoPago,a=e.monto,n=e.numeroTransaccion,o=e.onChange,i=e.add_to_id;return r.a.createElement(W.a,{container:!0},r.a.createElement(W.a,{item:!0,md:3,sm:12},r.a.createElement(Se,{placeholder:"M\xe9todo de pago",select:!0,SelectProps:{native:!0},name:"pago"+(i?"#"+i:"")+".metodoPago",value:t,onChange:function(e){return o("metodoPago",e.currentTarget.value)}},r.a.createElement("option",null,"- Selecciona una opci\xf3n -"),r.a.createElement("option",{value:"PICHINCHA"},"BANCO PICHINCHA"),r.a.createElement("option",{value:"PRODUBANCO"},"BANCO PRODUBANCO"),r.a.createElement("option",{value:"PAYPAL"},"PayPal"))),r.a.createElement(W.a,{item:!0,md:3,sm:6},r.a.createElement(Se,{placeholder:"# Comprobante",name:"pago"+(i?"#"+i:"")+".numeroTransaccion",type:"tel",value:n,onChange:function(e){return o("numeroTransaccion",e.currentTarget.value)}})),r.a.createElement(W.a,{item:!0,md:3,sm:6},r.a.createElement(Se,{InputProps:{startAdornment:r.a.createElement(E.a,{position:"start"},r.a.createElement(X.a,null))},placeholder:"Monto",type:"number",name:"pago"+(i?"#"+i:"")+".monto",inputProps:{step:"0.01"},value:a?""+a:"",onChange:function(e){return o("monto",e.currentTarget.value)}})))},Ot=function(e){var t=e.value||[];return r.a.createElement(fe.a,null,r.a.createElement(ge.a,{button:!0,onClick:function(){e.onChange([].concat(Object(ae.a)(t),[{metodoPago:"",monto:"",numeroTransaccion:""}]))}},"AGREGAR PAGO ",r.a.createElement(J.a,null)),t.map((function(a,n){return r.a.createElement(ge.a,{key:n},r.a.createElement("div",{style:{flex:1}},r.a.createElement(yt,Object.assign({},a,{add_to_id:""+n,onChange:function(n,r){return function(a,n,r){var o=t.indexOf(r),i=Object(p.a)(Object(p.a)({},r),{},Object(h.a)({},a,n)),l=Object(ae.a)(t);l[o]=i,e.onChange(l)}(n,r,a)}}))),r.a.createElement(Ue.a,null,r.a.createElement(b.a,{onClick:function(){return function(a){var n=t.indexOf(a),r=Object(ae.a)(t);r.splice(n,1),e.onChange(r)}(a)},type:"button"},r.a.createElement(Me.a,null))))})))},Ct=function(e){return r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},"ONLY"===e.showReject?null:r.a.createElement(O.a,{style:{margin:10,flex:1},onClick:e.onClick,variant:"outlined",color:"primary",disabled:Boolean(e.loadingAction),name:e.name||e.label},e.loadingAction===(e.name||e.label)?"CARGANDO...":e.label),e.showReject&&r.a.createElement(O.a,{style:{margin:10,flex:1},onClick:e.onClick,variant:"outlined",color:"secondary",disabled:Boolean(e.loadingAction),name:"RECHAZAR"},"RECHAZAR"===e.loadingAction?"CARGANDO...":"RECHAZAR"))},At=function(e){var t=e._fechaEnvio,a=e.src,n=e.onSubmit,o=e.onImageChange,i=e.onTextChange,l=e.loadingStatus;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ft,null,"ENVIAR (imagen opcional)"),r.a.createElement(xe,{onChange:o,src:a,className:"",title:"Gu\xeda de Env\xedo"}),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginTop:15,marginBottom:10}},r.a.createElement(y.a,{variant:"button",style:{marginRight:10,paddingTop:5}},"Fecha de Env\xedo"),r.a.createElement(v.a,{type:"date",fullWidth:!0,inputProps:{id:"_fechaEnvio"},name:"_fechaEnvio",value:t||"",style:{flex:1},onChange:i})),r.a.createElement(Ct,{loadingAction:l,label:"ENVIAR",showReject:!0,onClick:n}))},St=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:"data",_fechaEnvio:"",_fechaRecepcion:"",_pagos:[]},e.handleClose=function(t){e.props.onClose(e.state.shouldRefresh)},e.handleButton=function(t){var a=t.currentTarget.name;if(!e.state.loading){if("APROBAR"===a){var n=pt.Aprobar(e.state);if(!n)return;n.then((function(t){return e.props.onClose(!0)})).catch((function(t){alert(t.message),e.setState({loading:null})}))}if("RECHAZAR"===a){var r=pt.Rechazar(e.state);if(!r)return;r.then((function(t){return e.props.onClose(!0)})).catch((function(t){alert(t.message),e.setState({loading:null})}))}if("ENVIAR"===a){var o=pt.Enviar(e.state);if(!o)return;o.then((function(t){return e.props.onClose(!0)})).catch((function(t){alert(t.message),e.setState({loading:null})}))}if("FACTURAR"===a){var i=pt.Facturar(e.state);if(!i)return;i.then((function(t){return e.props.onClose(!0)})).catch((function(t){alert(t.message),e.setState({loading:null})}))}e.setState({loading:a})}},e.handleChange=function(t){var a=t.currentTarget,n=a.name,r=a.value;e.setState(Object(h.a)({},n,r))},e.handleCheck=function(t){var a=t.currentTarget,n=a.name,r=a.checked;e.setState(Object(h.a)({},n,r))},e.handleEnvioImg=function(t){e.setState({_envioImgSrcStatus:"loading"}),e.state._envioImgSrcStatus||qe(t).then((function(a){e.setState({_envioImgSrc:a,_envioImgFile:t,_envioImgSrcStatus:null})})).catch((function(e){alert("No se pudo cargar la imagen:"+e.message)}))},e.handlePagos=function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{_pagos:t}))},e}return Object(c.a)(a,[{key:"componentWillMount",value:function(){var e=this;S.GetOrder(this.props.id).then((function(t){return e.setState(Object(p.a)(Object(p.a)({},t),{},{loading:null}))})).catch((function(t){return e.setState({loading:"data-error",data_error_message:t.message})}))}},{key:"render",value:function(){var e=this.state,t=e.numero,a=e.data_error_message,n=e.fechaCreacion,o=e.fechaRecepcion,i=e.fechaEnvio,l=e.envioImgSrc,c=e.detalle,s=e.descuentoPorcentaje,u=e.descuentoTotal,d=e.observacion,m=e.direccion,p=e.sector,h=e.ciudad,f=e.referencia,g=e.tipo_envio,E=e.statusText,b=e.total,C=e.envio,A=e.username,S=e.subtotal,D=e.survey1,w=e.survey2,_=e.loading,T=e.documento,x=e.identificacion,k=e.razonSocial,j=e.telefono_factura,I=e.direccion_factura,P=e.email_factura,R=e.nombre_contacto,N=e.identificacion_contacto,L=e.documento_contacto,U=e.telefono_contacto,M=e.numeroFactura,F=e.bienRecibido,G=e.observacionRecepcion,B=(c||[]).filter((function(e){return e.descuentoTotal})).reduce((function(e,t){return e+t.cantidad*t.pvp_final}),0),W=!0===this.props.editable,z=E,H=(b-C).moneyRound();return"data"===_||"data-error"===_?r.a.createElement(ne.a,{open:!0,onClose:this.handleClose,maxWidth:"md"},r.a.createElement(le.a,{style:{textAlign:"center",paddingTop:100,width:400,height:400}},"data"===_?r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{size:100}),r.a.createElement(y.a,{variant:"h6"},"CARGANDO...")):null,"data-error"===_?r.a.createElement(r.a.Fragment,null,r.a.createElement(bt.a,{color:"secondary"}),r.a.createElement(y.a,{color:"secondary",variant:"h6"},a)):null)):r.a.createElement(ne.a,{open:!0,onClose:this.handleClose,maxWidth:"md"},r.a.createElement(ie.a,null,"PEDIDO #",t),r.a.createElement(le.a,null,r.a.createElement(gt,{value:new Date(n).toLocaleString(),label:"Fecha"}),r.a.createElement(gt,{value:A,label:"Usuario"}),r.a.createElement(gt,{value:z,label:"Estado"}),M&&r.a.createElement(gt,{value:M,label:"Factura #"}),i&&r.a.createElement(gt,{value:new Date(i).toLocaleDateString(),label:"Enviado"}),l&&r.a.createElement(Y.a,{component:"img",style:{height:"auto",width:"calc(100% - 20px)",objectFit:"contain",border:"1px solid black",margin:10},image:l,title:"Guia de Envio",onClick:function(){return vt(l)}}),o&&r.a.createElement(gt,{value:new Date(o).toLocaleDateString(),label:"Recibido"}),"RECIBIDO"===z&&r.a.createElement(gt,{value:F?"NO":"SI",label:"Incompleto"}),"RECIBIDO"===z&&r.a.createElement(gt,{label:"Comentarios",value:G}),r.a.createElement(ft,null,"PRODUCTOS"),r.a.createElement(ve,{items:c,descuento:{porcentaje:s,valor:u},valor_envio:C,total_pedido:H,gran_total:b,subtotal:S,subtotal_con_descuento:B,showComponentes:!0}),r.a.createElement(gt,{value:d,label:"Observaci\xf3n"}),r.a.createElement(ft,null,"DATOS DE ENTREGA"),r.a.createElement(gt,{value:R,label:"Nombre"}),r.a.createElement(gt,{value:N,label:ye(L)}),r.a.createElement(gt,{value:U,label:"Telefono"}),r.a.createElement(gt,{value:g,label:"Tipo de Env\xedo"}),r.a.createElement(gt,{value:h,label:"Ciudad"}),r.a.createElement(gt,{value:p,label:"Sector"}),r.a.createElement(gt,{value:m,label:"Direccion"}),r.a.createElement(gt,{value:f,label:"Referencia"}),r.a.createElement(ft,null,"DATOS DE FACTURACI\xd3N"),r.a.createElement(gt,{value:x,label:ye(T)}),r.a.createElement(gt,{value:k,label:"Nombre"}),r.a.createElement(gt,{value:I,label:"Direcci\xf3n"}),r.a.createElement(gt,{value:j,label:"Tel\xe9fono"}),r.a.createElement(gt,{value:P,label:"Email"}),r.a.createElement(Et,this.state),r.a.createElement(ft,null,"ENCUESTA"),r.a.createElement(y.a,{style:{marginTop:10},variant:"caption"},"C\xf3mo podemos ayudarte a mejorar tus ventas?"),r.a.createElement(y.a,null,D||""),r.a.createElement(y.a,{style:{marginTop:10},variant:"caption"},"Comp\xe1rtenos alguna experiencia que hayan tenido tus clientes usando nuestros productos"),r.a.createElement(y.a,null,w||""),"PENDIENTE"===z&&W&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ft,null,"APROBACI\xd3N"),r.a.createElement(Ot,{value:this.state._pagos,onChange:this.handlePagos}),r.a.createElement(Ct,{loadingAction:this.state.loading,label:"APROBAR",showReject:!0,onClick:this.handleButton})),"APROBADO"===z&&W&&r.a.createElement(At,{onSubmit:this.handleButton,_fechaEnvio:this.state._fechaEnvio,onTextChange:this.handleChange,onImageChange:this.handleEnvioImg,loadingStatus:this.state._envioImgSrcStatus,src:this.state._envioImgSrc}),"ENVIADO"===z&&W&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ft,null,"REGISTRAR FACTURA"),r.a.createElement(v.a,{label:"Numero de Factura",placeholder:"###-###-#####",value:M,inputProps:{id:"numeroFactura",maxLength:20},fullWidth:!0,onChange:this.handleChange,name:"numeroFactura"}),r.a.createElement(Ct,{loadingAction:this.state.loading,label:"FACTURAR",showReject:!0,onClick:this.handleButton})),"FACTURADO"===z&&W&&r.a.createElement(Ct,{loadingAction:this.state.loading,onClick:this.handleButton,showReject:"ONLY"})),r.a.createElement(ce.a,null,r.a.createElement(O.a,{onClick:this.handleClose},"SALIR")))}}]),a}(r.a.Component),Dt=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={data:[],msg:null,loading:!0},e.onMounted(e.match.path),n.handleClick=n.handleClick.bind(Object(P.a)(n)),n.handleClose=n.handleClose.bind(Object(P.a)(n)),n.handleMessage=n.handleMessage.bind(Object(P.a)(n)),n}return Object(c.a)(a,[{key:"componentWillMount",value:function(){var e=this;S.GetOrders().then((function(t){return e.setState({data:t,loading:null})})).catch((function(t){return e.setState({loading:null,msg:{title:"Ocurri\xf3 un error",message:t.message,info:t.code}})}))}},{key:"handleMessage",value:function(){this.setState({msg:null})}},{key:"handleClick",value:function(e){var t=e.currentTarget.id;this.props.history.push(this.props.match.path+"/"+t)}},{key:"handleClose",value:function(e){var t=this;e&&(this.setState({loading:!0}),S.GetOrders().then((function(e){return t.setState({data:e,loading:null})})).catch((function(e){return t.setState({msg:{title:"No se pudo actualizar el listado",message:e.message,info:e.code},loading:null})}))),this.props.history.push(this.props.match.path)}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.msg,o=t.loading,i=this.props.rol;return o?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(V.a,{size:100}),r.a.createElement(y.a,{variant:"h6"},"CARGANDO...")):r.a.createElement(F.a,{style:{width:"calc(100%-20px)",height:"calc(100% - 30px)",display:"flex",flexDirection:"column",margin:10,padding:10,paddingBottom:0,overflowX:"hidden"}},r.a.createElement(fe.a,null,r.a.createElement(L.a,{xsDown:!0,implementation:"css"},r.a.createElement(ge.a,null,r.a.createElement(W.a,{container:!0,spacing:1,style:{borderBottom:"1px solid #ebebeb"}},r.a.createElement(W.a,{sm:2,item:!0},r.a.createElement(y.a,{variant:"overline"},"Numero")),r.a.createElement(W.a,{sm:2,item:!0},r.a.createElement(y.a,{variant:"overline"},"Creado")),3===i&&r.a.createElement(W.a,{sm:3,item:!0},r.a.createElement(y.a,{variant:"overline"},"Usuario")),r.a.createElement(W.a,{sm:1,item:!0},r.a.createElement(y.a,{variant:"overline"},"Total")),1===i&&r.a.createElement(W.a,{sm:1,item:!0},r.a.createElement(y.a,{variant:"overline"},"Ganancia")),r.a.createElement(W.a,{sm:2,item:!0},r.a.createElement(y.a,{variant:"overline"},"Estado")),r.a.createElement(W.a,{sm:2,item:!0},r.a.createElement(y.a,{variant:"overline"},"Fecha de Env\xedo"))))),a.map((function(t){return r.a.createElement(ge.a,{key:t.id,id:""+t.id,button:!0,onClick:e.handleClick},r.a.createElement(W.a,{container:!0,spacing:1,style:{paddingTop:5,paddingBottom:5,borderBottom:"1px solid #fafafa"}},r.a.createElement(W.a,{xs:12,sm:2,item:!0},r.a.createElement(L.a,{smUp:!0},"PEDIDO #"),t.id),r.a.createElement(W.a,{xs:12,sm:2,item:!0},new Date(t.fechaCreacion).toLocaleDateString()),3===i&&r.a.createElement(W.a,{xs:12,sm:3,item:!0},t.username),r.a.createElement(W.a,{xs:12,sm:1,item:!0},"$ ",t.total.toFixed(2)),1===i&&r.a.createElement(W.a,{xs:12,sm:1,item:!0},"$ ",(t.descuentoTotal||0).toFixed(2)),r.a.createElement(W.a,{xs:12,sm:2,item:!0},r.a.createElement(y.a,{color:wt(t.statusText)},t.statusText)),r.a.createElement(W.a,{xs:12,sm:2,item:!0},t.fechaEnvio&&new Date(t.fechaEnvio).toDateString())))}))),n&&r.a.createElement(Pe,Object.assign({},n,{onClose:this.handleMessage})),r.a.createElement(d.b,{path:this.props.match.path+"/:id",render:function(t){return r.a.createElement(St,{id:+t.match.params.id,onClose:e.handleClose})}}))}}]),a}(r.a.PureComponent);function wt(e){return"APROBADO"===e?"primary":"RECHAZADO"===e?"secondary":"initial"}var _t=a(501),Tt=a(502),xt=a(503),kt=a(504);function jt(e){var t=e.onBackClick,a=e.loading,n=e.onNextClick,o=e.title,i=e.subtitle;return r.a.createElement(_t.a,{title:r.a.createElement("div",{style:{flex:1,display:"flex",flexDirection:"row"}},t&&r.a.createElement("div",null,r.a.createElement(b.a,{onClick:t,disabled:a},a?r.a.createElement(Tt.a,null):r.a.createElement(xt.a,null))),r.a.createElement("div",{style:{flex:1}},r.a.createElement(y.a,{variant:"h5"},o),r.a.createElement(y.a,{variant:"body1"},i)),n&&r.a.createElement("div",null,r.a.createElement(b.a,{onClick:n,disabled:a},a?r.a.createElement(Tt.a,null):r.a.createElement(kt.a,null)))),disableTypography:!0,style:{textAlign:"center"}})}function It(e){var t=e.data,a=e.col1,n=e.col2,o=e.secondColType,i=e.colType,l=Object(z.a)(e,["data","col1","col2","secondColType","colType"]);return r.a.createElement(f.a,{className:"dashboard-card",style:{display:"flex",flexDirection:"column"}},r.a.createElement(jt,l),r.a.createElement(g.a,{style:{flex:1,overflow:"auto"}},r.a.createElement(fe.a,null,t.sort((function(e,t){return t[a]-e[a]})).map((function(e,t){var l=e[a];if(n){var c=e[n];c=o&&"DATE"===o?function(e){if(!e)return"Nunca";var t=new Date(e);if(isNaN(+t))return e;var a=new Date;if(t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear())return t.toLocaleTimeString();for(var n=1;n<30;n++){var r=new Date(a.getFullYear(),a.getMonth(),a.getDate()-n);if(t.getDate()===r.getDate()&&t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear())return 1===n?"Ayer":"Hace "+n+" d\xedas"}return t.toLocaleDateString()}(e[n]):c.toFixed(2)}return r.a.createElement(ge.a,{key:t,id:"ranking-listitem-"+t},r.a.createElement("div",{style:{display:"table",width:"100%"}},r.a.createElement(y.a,{style:{display:"table-cell",width:50},variant:e.me?"body1":"caption"},"# ",t+1),r.a.createElement(y.a,{style:{display:"table-cell"},variant:e.me?"body1":"caption"},e.username),"PERFOMANCE"===i&&r.a.createElement(Pt,{value:l,me:e.me}),"MONEY"===i&&r.a.createElement(y.a,{style:{display:"table-cell",textAlign:"right",width:100},variant:e.me?"body1":"caption"},"$ ",l.toFixed(2)),"NUMBER"===i&&r.a.createElement(y.a,{style:{display:"table-cell",textAlign:"right",width:100},variant:e.me?"body1":"caption"},l),n?"PERFOMANCE"===o?r.a.createElement(Pt,{value:+c,me:e.me}):r.a.createElement(y.a,{style:{display:"table-cell",textAlign:"right",width:100,paddingLeft:10},variant:e.me?"body1":"caption"},"MONEY"===o?"$":null," ",c):null))})))))}function Pt(e){return r.a.createElement(y.a,{color:e.value?e.value>0?"primary":"secondary":"inherit",style:{display:"table-cell",textAlign:"right",width:100},variant:e.me?"body1":"caption"},"% ",e.value.toFixed(2)," ",e.value?e.value>0?"\u2191":"\u2193":null)}var Rt=a(170),Nt=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={options:{title:{display:!1},legend:{display:!1},maintainAspectRatio:!1,bezierCurve:!1,scales:{yAxes:[{ticks:{maxTicksLimit:10,padding:5,beginAtZero:!0}}],xAxes:[{ticks:{padding:5}}]}}},e}return Object(c.a)(a,[{key:"render",value:function(){for(var e=this.props,t=e.data,a=Object(z.a)(e,["data"]),n=[],o=[],i=0;i<t.length;i++){var l=t[i];if(l.we){var c=new Date(l.we);n.push("".concat(c.getDate()," ").concat(Oe(c.getMonth())))}else n.push(l.label);o.push(l.value)}var s={labels:n,datasets:[{backgroundColor:"#3f51b5",borderColor:"#3f51b5",data:o,lineTension:0,fill:!1}]};return r.a.createElement(f.a,{className:"dashboard-card",style:{display:"flex",flexDirection:"column"}},r.a.createElement(jt,a),r.a.createElement(g.a,{style:{width:"100%",flex:1,padding:5}},r.a.createElement(Rt.a,{options:this.state.options,data:s})))}}]),a}(r.a.PureComponent);function Lt(e){var t,a,n,o,i={acumulado:(null===e||void 0===e||null===(t=e.descuento)||void 0===t?void 0:t.acumulado)||0,ciclo:(null===e||void 0===e||null===(a=e.descuento)||void 0===a?void 0:a.ciclo)||0},l={acumulado:(null===e||void 0===e||null===(n=e.comision)||void 0===n?void 0:n.acumulado)||0,ciclo:(null===e||void 0===e||null===(o=e.comision)||void 0===o?void 0:o.ciclo)||0};return r.a.createElement(f.a,{className:"dashboard-card"},r.a.createElement(_t.a,{title:"GANANCIAS",style:{textAlign:"center"}}),r.a.createElement(g.a,null,r.a.createElement(y.a,{variant:"overline"},"Descuentos"),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:10}},r.a.createElement("div",{style:{textAlign:"center",flex:1}},r.a.createElement(y.a,{color:"primary",variant:"h5",style:{flex:1}},Ut(i.ciclo)),r.a.createElement(y.a,{color:"primary"},"ESTE CICLO")),r.a.createElement("div",{style:{borderLeft:"1px solid black",textAlign:"center",flex:1}},r.a.createElement(y.a,{variant:"h5",style:{flex:1}},Ut(i.acumulado)),r.a.createElement(y.a,null,"ACUMULADO"))),r.a.createElement(y.a,{variant:"overline"},"Comisiones"),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:10}},r.a.createElement("div",{style:{textAlign:"center",flex:1}},r.a.createElement(y.a,{color:"primary",variant:"h5",style:{flex:1}},Ut(l.ciclo)),r.a.createElement(y.a,{color:"primary"},"ESTE CICLO")),r.a.createElement("div",{style:{borderLeft:"1px solid black",textAlign:"center",flex:1}},r.a.createElement(y.a,{variant:"h5",style:{flex:1}},Ut(l.acumulado)),r.a.createElement(y.a,null,"ACUMULADO"))),r.a.createElement(y.a,{variant:"overline"},"Total"),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:10}},r.a.createElement("div",{style:{textAlign:"center",flex:1}},r.a.createElement(y.a,{color:"primary",variant:"h5",style:{flex:1}},Ut(l.ciclo+i.ciclo)),r.a.createElement(y.a,{color:"primary"},"ESTE CICLO")),r.a.createElement("div",{style:{borderLeft:"1px solid black",textAlign:"center",flex:1}},r.a.createElement(y.a,{variant:"h5",style:{flex:1}},Ut(l.acumulado+i.acumulado)),r.a.createElement(y.a,null,"ACUMULADO")))))}function Ut(e){return e?e>1e3?+(e/1e3).toFixed(1)+" K":e>1e6?+(e/1e3).toFixed(1)+" M":+e.toFixed(2):0}var Mt,Ft=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={options:{title:{display:!1},legend:{display:!1},maintainAspectRatio:!1}},e}return Object(c.a)(a,[{key:"render",value:function(){for(var e=[],t=[],a=[],n=this.props.data.sort((function(e,t){return t.value-e.value})),o=0;o<n.length;o++){var i=n[o];e.push(i.label),t.push(i.value),a.push(i.color)}var l={labels:e,datasets:[{backgroundColor:a,data:t}]};return r.a.createElement(f.a,{className:"dashboard-card",style:{display:"flex",flexDirection:"column"}},r.a.createElement(_t.a,{style:{textAlign:"center"},title:this.props.title}),r.a.createElement(g.a,{style:{width:"100%",flex:1,padding:5}},r.a.createElement(Rt.b,{options:this.state.options,data:l})))}}]),a}(r.a.PureComponent),Gt=function(e){return function(t){Object(s.a)(n,t);var a=Object(u.a)(n);function n(e){var t;return Object(l.a)(this,n),(t=a.call(this,e)).state={data:[],current_week:null,statName:null,reduceFn:null,loading:!1},t.handleBack=function(){t.state.loading||(t.setState({loading:!0}),t.fetchData(t.state.current_week.id-1))},t.handleNext=function(){t.state.loading||(t.setState({loading:!0}),t.fetchData(t.state.current_week.id+1))},t.updateData=function(e){var a=e.current_week,n=Object(z.a)(e,["current_week"]);t.setState({data:n[t.state.statName]||[],current_week:a,loading:!1})},t.showError=function(e){t.setState({loading:!1}),alert(e.message)},t.state=Object(p.a)({},e),t}return Object(c.a)(n,[{key:"fetchData",value:function(e){S.Stats({stats:[this.state.statName,"current_week"],semana:e}).then(this.updateData).catch(this.showError)}},{key:"render",value:function(){var t=this.state,a=t.current_week,n=t.data,o=t.reduceFn,i=t.loading,l="";if(a){var c=new Date(a.start),s=new Date(a.end);l="".concat(c.getDate()," ").concat(Oe(c.getMonth())," - ")+"".concat(s.getDate()," ").concat(Oe(s.getMonth()))}var u=this.state,d=(n=u.data,Object(z.a)(u,["data"]));return o&&(n=o(n)),r.a.createElement(e,Object.assign({},d,{data:n,subtitle:l,loading:i,onBackClick:this.handleBack,onNextClick:this.handleNext}))}}]),n}(r.a.Component)};!function(e){e[e.ASESOR=1]="ASESOR",e[e.GUIA=2]="GUIA",e[e.ADMINISTRADOR=3]="ADMINISTRADOR"}(Mt||(Mt={}));var Bt=function(e){return function(t){Object(s.a)(n,t);var a=Object(u.a)(n);function n(e){var t;return Object(l.a)(this,n),(t=a.call(this,e)).state={data:{},current_cycle:null,stats:[],loading:!1},t.handleBack=function(){t.state.loading||(t.setState({loading:!0}),t.fetchData(t.state.current_cycle.index-1))},t.handleNext=function(){t.state.loading||(t.setState({loading:!0}),t.fetchData(t.state.current_cycle.index+1))},t.updateData=function(e){var a=e.current_cycle,n=Object(z.a)(e,["current_cycle"]);t.setState({data:n,current_cycle:a,loading:!1})},t.showError=function(e){t.setState({loading:!1}),alert(e.message)},t.state.stats=e.stats,t.state.current_cycle=e.current_cycle,t.state.data=e.data,t}return Object(c.a)(n,[{key:"fetchData",value:function(e){S.Stats({stats:[].concat(Object(ae.a)(this.state.stats),["current_cycle"]),cycleIndex:e}).then(this.updateData).catch(this.showError)}},{key:"render",value:function(){var t=this.props,a=(t.stats,t.title),n=Object(z.a)(t,["stats","title"]),o=this.state,i=o.current_cycle,l=o.loading,c=o.data,s="";if(i){var u=new Date(i.start),d=new Date(i.end);s="".concat(u.getDate()," ").concat(Oe(u.getMonth())," - ")+"".concat(d.getDate()," ").concat(Oe(d.getMonth()))}var m=Object(p.a)(Object(p.a)({},n),{},{current_cycle:i,loading:l,data:c});return r.a.createElement(f.a,{style:{display:"flex",flexDirection:"column"}},r.a.createElement(jt,{loading:l,onBackClick:i&&i.index?this.handleBack:null,onNextClick:this.handleNext,subtitle:s,title:a}),r.a.createElement(g.a,{style:{flex:1,padding:0,overflow:"hidden"}},r.a.createElement(e,m)))}}]),n}(r.a.Component)},Vt=function(e){e.show;var t=Object(z.a)(e,["show"]),a=Object(p.a)(Object(p.a)({},t),{},{item:!0,xs:12});return e.show?r.a.createElement(W.a,a,e.children):null},Wt=a(505),zt=a(506),Ht=a(288),qt=a(507),Yt=a(30),Kt=a(310),Zt=function(e){var t=e.data.sort((function(e,t){return e.nombre-t.nombre})).map((function(e){return{key:e.id,name:(e.esUsuarioNuevo?"\u2b50 ":"")+e.nombre+" - "+(e.total_comisionable||0).toCurrency(),parent:e.parent1||void 0,background:e.total_comisionable>0?"#31d45f":"#1F4963"}}));return r.a.createElement(Kt.a,{initDiagram:Xt,divClassName:"diagram-component",nodeDataArray:t})};function Jt(e){var t,a=(t=e.usuarios,r.a.useMemo((function(){return t.reduce((function(e,t){return t.isCurrentUser||(t.esUsuarioNuevo&&e.nuevos++,t.total_comisionable>0&&e.activos++,e.total++),e}),{total:0,activos:0,nuevos:0})}),[t,t.length]));return r.a.createElement("div",{style:{padding:10}},r.a.createElement("div",null,r.a.createElement("div",{style:{marginRight:5,background:"#31d45f",minWidth:13,minHeight:13,display:"inline-block"}}),r.a.createElement(y.a,{style:{display:"inline-block"}},"Usuarios activos - ",a.activos.toLocaleString(void 0,{maximumFractionDigits:0}))),r.a.createElement("div",null,r.a.createElement("div",{style:{marginRight:5,background:"#1F4963",minWidth:13,minHeight:13,display:"inline-block"}}),r.a.createElement(y.a,{style:{display:"inline-block"}},"Usuarios inactivos - ",(a.total-a.activos).toLocaleString(void 0,{maximumFractionDigits:0}),"  | Total de Usuarios : ",a.total," ")),r.a.createElement("div",null,r.a.createElement("div",{style:{marginRight:5,minWidth:13,minHeight:13,display:"inline-block"}},"\u2b50"),r.a.createElement(y.a,{style:{display:"inline-block"}},"Usuarios nuevos - ",a.nuevos.toLocaleString(void 0,{maximumFractionDigits:0}))))}function Xt(){var e=Yt.d.make,t=e(Yt.b,{initialAutoScale:Yt.b.UniformToFill,layout:e(Yt.l,{nodeSpacing:5,layerSpacing:30}),model:new Yt.m({isReadOnly:!0})});return t.nodeTemplate=e(Yt.f,"Horizontal",e(Yt.h,"Auto",e(Yt.i,{stroke:null},new Yt.a("fill","background")),e(Yt.k,{font:"bold 13px Helvetica, bold Arial, sans-serif",stroke:"white",margin:3},new Yt.a("text","name"))),e("TreeExpanderButton")),t.linkTemplate=e(Yt.e,{selectable:!1},e(Yt.i)),t}var Qt=function(e){var t=r.a.useMemo((function(){var t=[];return e.n1_usuarios&&t.push({usuarios:e.n1_usuarios,activos:e.n1_activos,comisionable:e.n1_comisionable,comision:e.n1_subtotal_comision}),e.n2_usuarios?(t.push({usuarios:e.n2_usuarios,activos:e.n2_activos,comisionable:e.n2_comisionable,comision:e.n2_subtotal_comision}),e.n3_usuarios?(t.push({usuarios:e.n3_usuarios,activos:e.n3_activos,comisionable:e.n3_comisionable,comision:e.n3_subtotal_comision}),t):t):t}),Object.values(e)),a=t.reduce((function(e,t){return e.nX_activos+=t.activos,e.nX_usuarios+=t.usuarios,e}),{nX_activos:0,nX_usuarios:0}),n=a.nX_activos,o=a.nX_usuarios;return r.a.createElement(fe.a,null,r.a.createElement(ge.a,{dense:!0},r.a.createElement(Le.a,{primaryTypographyProps:{variant:"button"},primary:"Venta Comisionable"}),r.a.createElement(Ue.a,null,r.a.createElement(y.a,{variant:"button"},"Comision"))),r.a.createElement(ge.a,{dense:!0},r.a.createElement(Le.a,{primary:"Venta Individual",secondary:"Valor Comisionable: ".concat(e.total_calificable.toCurrency())}),r.a.createElement(Ue.a,null)),t.map((function(e,t){return r.a.createElement(ge.a,{dense:!0,key:t},r.a.createElement(Le.a,{primary:"Nivel ".concat(t+1," (").concat(e.activos," / ").concat(e.usuarios,")"),secondary:"Valor Comisionable: ".concat(e.comisionable.toCurrency())}),r.a.createElement(Ue.a,null,e.comision.toCurrency()))})),r.a.createElement(ge.a,{dense:!0,style:{borderTop:"1px solid #eaeaea"}},r.a.createElement(Le.a,{primaryTypographyProps:{variant:"button"},primary:"Total",secondary:"".concat(n," / ").concat(o)}),r.a.createElement(Ue.a,null,r.a.createElement(y.a,{variant:"button"},e.subtotal_comision.toCurrency()," + imp"))))},$t=a(446),ea=Gt(It),ta=Gt(Nt),aa=Bt((function(e){var t=e.data,a=t.descendants,n=t.descendants_resume,o=r.a.useState([]),i=Object(B.a)(o,2),l=i[0],c=i[1];r.a.useEffect((function(){S.Rangos().then((function(e){return c(e)}))}),[]);var s=null===n||void 0===n?void 0:n.titulo,u=l.findIndex((function(e){return e.id===s}));return r.a.createElement(W.a,{container:!0,spacing:2},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(Wt.a,{style:{width:"100%",padding:0,paddingTop:0,paddingBottom:10},alternativeLabel:!0,activeStep:u,color:"primary"},l.map((function(e){return r.a.createElement(zt.a,{key:e.id},r.a.createElement(Ht.a,{title:e.nombre},r.a.createElement(qt.a,null,r.a.createElement(y.a,{variant:"caption"},e.id))))})))),r.a.createElement(W.a,{item:!0,xs:12,sm:8},r.a.createElement("div",{className:"dashboard-card"},r.a.createElement(Zt,{data:a})),r.a.createElement(L.a,{smUp:!0},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(Jt,{usuarios:a}),r.a.createElement("hr",null)))),r.a.createElement(W.a,{item:!0,xs:12,sm:4},r.a.createElement(Qt,n||{})),r.a.createElement(L.a,{xsDown:!0},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(Jt,{usuarios:a}))))})),na=Bt((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Zt,{data:e.data.descendants}),r.a.createElement(Jt,{usuarios:e.data.descendants||[]}))}));var ra=Object($t.a)((function(e){return{root:{margin:"auto",width:"calc(100% - ".concat(2*e.spacing(2),"px)"),textAlign:"center",overflow:"hidden"}}}))(function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).unmounted=!1,n.state={loading:!0,error:null,week_ranking:[],group_graph:[],personal_graph:[],year_sales:[],product_resume:[],group_ranking:[],descendants:[],descendants_resume:null,current_week:null,current_cycle:null,profit_summary:null},n.componentWillUnmount=function(){return n.unmounted=!0},n.productResumeReducer=function(e){return e.map((function(e){return e.username=e.label,e}))},n.esAdmin=function(){return n.props.rol===Mt.ADMINISTRADOR},e.onMounted(e.match.path),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=["week_ranking","personal_graph","year_sales","product_resume","current_week","descendants","current_cycle","profit_summary"];this.esAdmin()||t.push("descendants_resume"),S.Stats({stats:t}).then((function(t){e.unmounted||e.setState(Object(p.a)(Object(p.a)({},t),{},{loading:null}))})).catch((function(t){e.unmounted||e.setState({error:t,loading:null})}))}},{key:"render",value:function(){for(var e=this.state,t=e.loading,a=e.error,n=e.week_ranking,o=e.personal_graph,i=e.group_graph,l=e.year_sales,c=e.product_resume,s=e.group_ranking,u=e.current_week,d=e.descendants,m=e.descendants_resume,p=e.current_cycle,h=e.profit_summary,f=this.props,g=(f.rol,f.username),v={month:0,year:0},E=new Date,b=this.esAdmin(),O=0;O<l.length;O++){var A=l[O];A.createdAt=new Date(A.createdAt),A.createdAt.getMonth()===E.getMonth()&&A.createdAt.getFullYear()===E.getFullYear()&&(v.month+=A.profit),v.year+=A.profit}return t?r.a.createElement("div",{style:{width:"100%",paddingTop:100,textAlign:"center"}},r.a.createElement(V.a,{size:100}),r.a.createElement(y.a,{variant:"h6"},"CARGANDO...")):a?r.a.createElement("div",{style:{width:"100%",paddingTop:100,textAlign:"center"}},r.a.createElement(y.a,{variant:"h5"},"OCURRI\xd3 UN PROBLEMA"),r.a.createElement(y.a,{variant:"subtitle1"},a.message),r.a.createElement(y.a,{variant:"body1"},a.status," ",a.code)):r.a.createElement(W.a,{container:!0,spacing:2,className:this.props.classes.root},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(y.a,{color:"primary",variant:"h6"},"Hola ",g,". Esta es tu oficina virtual."),r.a.createElement(y.a,{variant:"subtitle1"},"Estamos aqu\xed para prosperar juntos.")),r.a.createElement(Vt,{show:s&&s.length>0},r.a.createElement(ea,{statName:"group_ranking",data:s,current_week:u,title:"RANKING DE GRUPOS",colType:"MONEY",secondColType:"MONEY",col1:"stat",col2:"ventas_lider"})),r.a.createElement(W.a,{item:!0,sm:6,xs:12},r.a.createElement(ta,{data:o,statName:"personal_graph",current_week:u,title:"ESTADISTICA SEMANAL"})),r.a.createElement(Vt,{sm:6,show:i&&i.length>0},r.a.createElement(Ft,{data:c,title:"PRODUCTOS VENDIDOS"})),r.a.createElement(Vt,{sm:6,show:!b&&!!Object.values(h||{}).filter((function(e){return e})).length},r.a.createElement(Lt,h||{})),r.a.createElement(L.a,{smUp:!0},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(C.a,null))),r.a.createElement(Vt,{sm:6,show:b},r.a.createElement(ea,{current_week:u,statName:"product_resume",reduceFn:this.productResumeReducer,data:c,title:"PRODUCTOS VENDIDOS",colType:"NUMBER",col1:"value"})),r.a.createElement(Vt,{sm:6,show:b},r.a.createElement(ea,{statName:"week_ranking",current_week:u,data:n,reduceFn:function(e){return b?e.filter((function(e){return e.rol===Mt.ADMINISTRADOR})):e},title:"RANKING DE LA SEMANA",colType:"MONEY",secondColType:"DATE",col1:"stat",col2:"ultimoPedido"})),r.a.createElement(Vt,{sm:6,show:b},r.a.createElement(It,{data:n,title:"RANKING ACUMULATIVO",colType:"MONEY",col1:"monto_acumulativo"})),r.a.createElement(L.a,{smUp:!0},r.a.createElement(W.a,{item:!0,xs:12},r.a.createElement(C.a,null))),r.a.createElement(Vt,{show:!b&&m&&d.length>1},r.a.createElement(aa,{stats:["descendants","descendants_resume"],data:{descendants_resume:m,descendants:d},current_cycle:p,title:"Genealog\xeda"})),r.a.createElement(Vt,{show:b&&d.length>1},r.a.createElement(na,{stats:["descendants"],data:{descendants:d},current_cycle:p,title:"Genealog\xeda Completa"})))}}]),a}(r.a.Component)),oa=a(289),ia=a(290),la=a(291),ca=a(292),sa=a(293),ua=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:null,error:null,data:[]},e.handleClick=function(){if(!e.state.loading){var t=e.valueOf("desde"),a=e.valueOf("hasta"),n=e.valueOf("estado");if(!t||isNaN(+new Date(t)))return alert("Selecciona la fecha desde");if(!a||isNaN(+new Date(a)))return alert("Selecciona la fecha hasta");if(!n)return alert("Selecciona el estado");e.setState({loading:!0}),t=new Date(t).toJSON(),a=new Date(a).toJSON(),S.ProductSalesReport({desde:t,hasta:a,estado:n}).then((function(t){return e.setState({data:t,loading:null,error:null})})).catch((function(t){return e.setState({error:t,loading:null})}))}},e}return Object(c.a)(a,[{key:"valueOf",value:function(e){var t=document.getElementById(e);return t&&t.value}},{key:"render",value:function(){var e=this.state,t=e.data,a=e.error,n=e.loading;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",null,r.a.createElement(v.a,{style:{marginLeft:10,marginRight:10},type:"datetime-local",inputProps:{id:"desde"}}),r.a.createElement(v.a,{style:{marginLeft:10,marginRight:10},type:"datetime-local",inputProps:{id:"hasta"}}),r.a.createElement(v.a,{style:{marginLeft:10,marginRight:10},select:!0,SelectProps:{native:!0},inputProps:{id:"estado"}},r.a.createElement("option",{value:1},"PENDIENTE"),r.a.createElement("option",{value:0},"APROBADO"),r.a.createElement("option",{value:2},"RECHAZADO"),r.a.createElement("option",{value:3},"ENTREGADO")),r.a.createElement(O.a,{disabled:n,style:{marginLeft:10,marginRight:10},variant:"outlined",onClick:this.handleClick},"GENERAR")),n?r.a.createElement("div",{style:{width:"100%",marginTop:100,textAlign:"center"}},r.a.createElement(V.a,{size:100}),r.a.createElement(y.a,{variant:"h6"},"CARGANDO...")):a?r.a.createElement("div",{style:{width:"100%",marginTop:100,textAlign:"center"}},r.a.createElement(y.a,{variant:"h4"},"OCURRI\xd3 UN ERROR"),r.a.createElement(y.a,{variant:"subtitle1"},a.message),r.a.createElement(y.a,{variant:"subtitle2"},a.code," ",a.status)):r.a.createElement("div",null,r.a.createElement(oa.a,null,r.a.createElement(ia.a,null,r.a.createElement(la.a,null,r.a.createElement(ca.a,{component:"th"},"Fecha"),r.a.createElement(ca.a,{component:"th"},"#"),r.a.createElement(ca.a,{component:"th"},"Usuario"),r.a.createElement(ca.a,{component:"th"},"Estado"),r.a.createElement(ca.a,{component:"th"},"Observacion"),r.a.createElement(ca.a,{component:"th"},"Fecha Env\xedo"),r.a.createElement(ca.a,{component:"th"},"Entregado"),r.a.createElement(ca.a,{component:"th"},"Motivo Anulacion"),r.a.createElement(ca.a,{component:"th"},"Producto"),r.a.createElement(ca.a,{component:"th"},"Cant"))),r.a.createElement(sa.a,null,t.map((function(e){return r.a.createElement(la.a,{key:e.id},r.a.createElement(ca.a,null,new Date(e.createdAt).toLocaleDateString()),r.a.createElement(ca.a,null,e.idPedido),r.a.createElement(ca.a,null,e.username),r.a.createElement(ca.a,null,e.estado),r.a.createElement(ca.a,null,e.observacion),r.a.createElement(ca.a,null,e.fechaEntrega&&new Date(e.fechaEntrega).toLocaleDateString()),r.a.createElement(ca.a,null,e.fechaEntrega&&new Date(e.fechaEntrega).toLocaleDateString()),r.a.createElement(ca.a,null,e.motivoAnulacion),r.a.createElement(ca.a,null,e.descripcion),r.a.createElement(ca.a,null,e.cantidad))}))))))}}]),a}(r.a.Component),da=a(67),ma=function(){var e=r.a.createRef(),t=r.a.useState((new Date).valueOf()),a=Object(B.a)(t,1)[0],n=r.a.useState(da("yyyy-MM-dd",new Date((new Date).getFullYear(),(new Date).getMonth(),1))),o=Object(B.a)(n,2),i=o[0],l=o[1],c=r.a.useState(da("yyyy-MM-dd",new Date((new Date).getFullYear(),(new Date).getMonth()+1,-1))),s=Object(B.a)(c,2),u=s[0],d=s[1],m=r.a.useState("0"),p=Object(B.a)(m,2),h=p[0],f=p[1],g=function(){return E&&E.toJSON()?b&&b.toJSON()?null===h||void 0===h?"Seleccione el estado":void 0:"Digite una fecha `hasta` valida":"Digite una fecha `Desde` valida "};try{var E=da.parse("yyyy-MM-dd hh:mm:ss.SSS",i+" 00:00:00.000"),b=da.parse("yyyy-MM-dd hh:mm:ss.SSS",u+" 00:00:00.000")}catch(y){console.error(y.message,{desde:i,hasta:u})}return r.a.createElement("div",{style:{paddingTop:10,paddingBottom:20}},r.a.createElement(v.a,{style:{marginLeft:10,marginRight:10},type:"date",onChange:function(e){return l(e.currentTarget.value)},value:i}),r.a.createElement(v.a,{style:{marginLeft:10,marginRight:10},type:"date",onChange:function(e){return d(e.currentTarget.value)},value:u}),r.a.createElement(v.a,{style:{marginLeft:10,marginRight:10},select:!0,onChange:function(e){return f(e.currentTarget.value)},value:h,SelectProps:{native:!0}},r.a.createElement("option",{value:"0"},"APROBADO"),r.a.createElement("option",{value:"3"},"ENVIADO"),r.a.createElement("option",{value:"5"},"FACTURADO")),r.a.createElement(O.a,{style:{marginLeft:10,marginRight:10},variant:"outlined",onClick:function(){var t=g();if(t)return alert(t);e.current.href="".concat(S.ServerURL(),"/reports/items-invoice-report.xlsx?from=").concat(E.toJSON(),"&to=").concat(b.toJSON(),"&estado=").concat(h),e.current.click()}},"DESCARGAR PRODUCTOS"),r.a.createElement(O.a,{style:{marginLeft:10,marginRight:10},variant:"outlined",onClick:function(){var t=g();if(t)return alert(t);e.current.href="".concat(S.ServerURL(),"/reports/payments-invoice-report.xlsx?from=").concat(E.toJSON(),"&to=").concat(b.toJSON(),"&estado=").concat(h),e.current.click()}},"DESCARGAR PAGOS"),r.a.createElement("a",{style:{display:"none"},ref:e,target:"_blank",download:!0,id:"a-download-no-"+a}))},pa=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={currentTab:0},n.handleChange=function(e,t){n.setState({currentTab:t})},e.onMounted(e.match.path),n}return Object(c.a)(a,[{key:"render",value:function(){var e=this.state.currentTab;return r.a.createElement(F.a,{style:{margin:10}},r.a.createElement(U.a,{style:{marginBottom:10},value:e,onChange:this.handleChange},r.a.createElement(M.a,{label:"Detalle de Productos"}),r.a.createElement(M.a,{label:"Reporte de Facturaci\xf3n"})),0===e&&r.a.createElement(ua,null),1===e&&r.a.createElement(ma,null))}}]),a}(r.a.Component),ha=a(308),fa=a.n(ha),ga=function(e){var t=e.options,a=Object(z.a)(e,["options"]),n=t||{},o=(n.download,n.downloadOptions),i=n.customToolbar,l=Object(z.a)(n,["download","downloadOptions","customToolbar"]),c=r.a.useState(","),s=Object(B.a)(c,2),u=s[0],d=s[1];return r.a.createElement(fa.a,Object.assign({options:Object(p.a)(Object(p.a)({},l||{}),{},{customToolbar:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{value:u,onChange:function(e){return d(e.target.value)},select:!0,SelectProps:{native:!0},helperText:"descarga de csv",label:"Separador"},r.a.createElement("option",{value:","},", (MAC)"),r.a.createElement("option",{value:";"},"; (Windows)")),r.a.createElement("div",{style:{height:"100%",right:"1px solid #eaeaea",marginLeft:5,marginRight:10}}),i?i.apply(void 0,arguments):null)},onDownload:function(e,t,a,n){return window.confirm("Hacer archivo compatible con Microsoft Excel (para lectura de caracteres especiales) ?")?"\ufeff"+e(a)+t(n):e(a)+t(n)},downloadOptions:Object(p.a)({separator:u},o||{})})},a||{}))},va=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t,a){e.props.onClick(t[0])},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.columns,o=a.filter((function(t){return t.estado===e.props.estado})).sort((function(e,t){return e.changedAt-t.changedAt}));return r.a.createElement(ga,{title:"",data:o,columns:n,options:{selectableRows:"none",onRowClick:this.handleClick}})}}]),a}(r.a.PureComponent),Ea=[{name:"id",label:"#",options:{filter:!0,sort:!0}},{name:"fechaCreacion",label:"Fecha",options:{filter:!0,sort:!0}},{name:"username",label:"Usuario",options:{filter:!0,sort:!0}},{name:"razonSocial",label:"Cliente",options:{filter:!0,sort:!0}},{name:"total",label:"Total",options:{filter:!1,sort:!0}},{name:"numeroTransaccion",label:"# Comprobante",options:{filter:!1,sort:!0}}],ba=[{name:"id",label:"#",options:{filter:!0,sort:!0}},{name:"fechaCreacion",label:"Fecha",options:{filter:!0,sort:!0}},{name:"username",label:"Usuario",options:{filter:!0,sort:!0}},{name:"razonSocial",label:"Cliente",options:{filter:!0,sort:!0}},{name:"total",label:"Total",options:{filter:!0}}],ya=[{name:"id",label:"#",options:{filter:!0,sort:!0}},{name:"fechaCreacion",label:"Fecha",options:{filter:!0,sort:!0}},{name:"fechaEnvio",label:"Enviado",options:{filter:!0,sort:!0}},{name:"username",label:"Usuario",options:{filter:!0,sort:!0}},{name:"razonSocial",label:"Cliente",options:{filter:!0,sort:!0}},{name:"comisionableTotal",label:"Comisionable",options:{filter:!0,sort:!0}},{name:"total",label:"Total",options:{filter:!0}}],Oa=[{name:"id",label:"#",options:{filter:!0,sort:!0}},{name:"fechaCreacion",label:"Fecha",options:{filter:!0,sort:!0}},{name:"fechaRecepcion",label:"Recepcion",options:{filter:!0,sort:!0}},{name:"username",label:"Usuario",options:{filter:!0,sort:!0}},{name:"razonSocial",label:"Cliente",options:{filter:!0,sort:!0}},{name:"comisionableTotal",label:"Comisionable",options:{filter:!0,sort:!0}},{name:"total",label:"Total",options:{filter:!1,sort:!0}},{name:"bienRecibido",label:"Incompleto",options:{filter:!0,sort:!0}},{name:"observacionRecepcion",label:"Observaciones",options:{sort:!1,filter:!1}},{name:"numeroFactura",label:"Factura",options:{filter:!1,sort:!0}}],Ca=[{name:"id",label:"#",options:{filter:!0,sort:!0}},{name:"fechaCreacion",label:"Fecha",options:{filter:!0,sort:!0}},{name:"fechaAnulacion",label:"Rechazado",options:{filter:!0,sort:!0}},{name:"username",label:"Usuario",options:{filter:!0,sort:!0}},{name:"razonSocial",label:"Cliente",options:{filter:!0,sort:!0}},{name:"total",label:"Total",options:{filter:!1,sort:!0}},{name:"motivoAnulacion",label:"Motivo",options:{filter:!1,sort:!1}}],Aa=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:[],loading:!0,error:null,id:null},e.handleTab=function(t,a){e.props.history.push(e.props.match.path+a)},e.openOrder=function(t){e.props.history.push(e.props.match.path+e.currentTab()+"/"+t)},e.closeOrder=function(t){t&&e.loadData(),e.props.history.push(e.props.match.path+e.currentTab())},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.onMounted&&this.props.onMounted(this.props.match.path),this.loadData()}},{key:"loadData",value:function(){var e=this;S.GetOrders().then((function(t){var a=t.map((function(e){var t=new Date(e.fechaCreacion);return e.fechaCreacion=t.toLocaleDateString(),e.fechaEnvio=e.fechaEnvio&&new Date(e.fechaEnvio).toLocaleDateString(),e.fechaRecepcion=e.fechaRecepcion&&new Date(e.fechaRecepcion).toLocaleDateString(),e.fechaAnulacion=e.fechaAnulacion&&new Date(e.fechaAnulacion).toLocaleDateString(),e.fechaAnulacion&&console.info(e),e.total=e.total.toFixed(2),e.bienRecibido=e.bienRecibido?"":"SI",e.changedAt=e.changedAt?new Date(e.changedAt).valueOf():0,e}));e.setState({data:a,loading:null})})).catch((function(t){return e.setState({error:t})}))}},{key:"currentTab",value:function(){return"/"+(this.props.location.pathname.split("/")[2]||"inbox")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(re.a,{position:"relative",color:"primary"},r.a.createElement(U.a,{onChange:this.handleTab,value:this.currentTab(),variant:"fullWidth"},r.a.createElement(M.a,{label:"Entrada",value:"/inbox"}),r.a.createElement(M.a,{label:"Aprobado",value:"/ok"}),r.a.createElement(M.a,{label:"Enviado",value:"/sent"}),r.a.createElement(M.a,{label:"Facturado",value:"/invoice"}),r.a.createElement(M.a,{label:"Rechazado",value:"/denied"}))),r.a.createElement(d.d,null,r.a.createElement(d.b,{path:this.props.match.path+"/inbox",render:function(t){return r.a.createElement(va,{columns:Ea,data:e.state.data,onClick:e.openOrder,estado:"PENDIENTE"})}}),r.a.createElement(d.b,{path:this.props.match.path+"/ok",render:function(t){return r.a.createElement(va,{columns:ba,data:e.state.data,onClick:e.openOrder,estado:"APROBADO"})}}),r.a.createElement(d.b,{path:this.props.match.path+"/sent",render:function(t){return r.a.createElement(va,{columns:ya,data:e.state.data,onClick:e.openOrder,estado:"ENVIADO"})}}),r.a.createElement(d.b,{path:this.props.match.path+"/invoice",render:function(t){return r.a.createElement(va,{columns:Oa,data:e.state.data,onClick:e.openOrder,estado:"FACTURADO"})}}),r.a.createElement(d.b,{path:this.props.match.path+"/denied",render:function(t){return r.a.createElement(va,{columns:Ca,data:e.state.data,onClick:e.openOrder,estado:"RECHAZADO"})}}),r.a.createElement(d.b,{path:this.props.match.path+"/",exact:!0},r.a.createElement(d.a,{to:this.props.match.path+"/inbox"}))),r.a.createElement(d.b,{path:this.props.match.path+"/:group/:id",render:function(t){return r.a.createElement(St,{id:+t.match.params.id,onClose:e.closeOrder,editable:!0})}}))}}]),a}(r.a.Component),Sa=a(510),Da=0,wa=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={inputValue:"",selectValue:"",showErrors:!1},n.INPUT_ID="CUSTOM_INPUT_ID_NO_",n.SELECT_ID="CUSTOM_SELECT_ID_NO_",n.handleDelete=function(e){var t=e.currentTarget.value,a=n.props.items[t];n.props.onRemove({name:n.props.name,item:a})},n.handleAdd=function(){var e=n.props,t=e.InputConfig,a=e.IdProp,r=e.dataSource,o=e.onAdd,i=e.name,l=n.state,c=l.inputValue,s=l.selectValue;if(t&&_a(c,t))return window.requestAnimationFrame((function(){try{document.getElementById(n.INPUT_ID).focus()}catch(e){}})),n.setState({showErrors:!0});if(!s)return window.requestAnimationFrame((function(){try{document.getElementById(n.SELECT_ID).focus()}catch(e){}})),n.setState({showErrors:!0});var u=r.find((function(e){return e[a].toString()===s.toString()}));o({name:i,item:Object(p.a)({},u),inputValue:c}),n.setState({selectValue:"",inputValue:"",showErrors:!1})},n.handleChange=function(e){var t=e.currentTarget,a=t.name,r=t.value;n.setState(Object(h.a)({},a,r))},n.INPUT_ID+=Da,n.SELECT_ID+=Da,Da++,n}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.InputConfig,n=t.DisplayProp,o=t.IdProp,i=t.SecondaryDisplayProp,l=t.items,c=this.props.dataSource,s=this.state,u=s.inputValue,d=s.selectValue,m=s.showErrors,p=m&&a?_a(u,a):"",h=m?d?"":"Selecciona un item":"",f=this.props.items.map((function(e){return e[o]}));return c=c.filter((function(e){return f.indexOf(e[o])<0})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"calc(100% - 20px)",margin:"auto"}},r.a.createElement(v.a,{style:{flex:1,marginTop:8,marginBottom:8},inputProps:{id:this.SELECT_ID},SelectProps:{native:!0},error:!!h,helperText:h,select:!0,name:"selectValue",value:d,onChange:this.handleChange},r.a.createElement("option",{value:""}," - SELECCIONA UNA OPCI\xd3N - "),c.map((function(e){return r.a.createElement("option",{key:e[o],value:e[o]},e[n])}))),a&&r.a.createElement(v.a,{error:!!p,helperText:p,style:{margin:10},margin:"dense",type:a.type||"text",value:u,name:"inputValue",onChange:this.handleChange,placeholder:a.label||"",inputProps:{id:this.INPUT_ID}}),r.a.createElement("div",null,r.a.createElement(b.a,{onClick:this.handleAdd},r.a.createElement(J.a,null)))),l&&l.length?r.a.createElement(fe.a,null,l.map((function(t,a){return r.a.createElement(ge.a,{key:t[o],dense:!0},i&&r.a.createElement(Sa.a,null,t[i]),r.a.createElement(Le.a,null,t[n]),r.a.createElement(Ue.a,null,r.a.createElement(b.a,{value:a,name:"delete",onClick:e.handleDelete},r.a.createElement(Me.a,null))))}))):null)}}]),a}(r.a.PureComponent);function _a(e,t){var a=(e||"").trim();return a?"number"===t.type&&isNaN(+a)?"Digite un n\xfamero":void 0:"Digite un valor"}var Ta=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.handleChange=function(t){var a=t.currentTarget,n=a.name,r=a.value;e.setState(Object(h.a)({},n,r))},e.handleChecked=function(t){var a=t.currentTarget,n=a.name,r=a.checked;e.setState(Object(h.a)({},n,r))},e.handleDelete=function(){e.state.id&&(window.confirm("Deseas continuar con esta acci\xf3n?")&&(e.setState({loading:"ELIMINAR"}),S.DeleteProduct(e.state.id).then(e._updated).catch(e._failed)))},e.handleSave=function(){var t=e._validar(e.state);if(t)return mt(Object.keys(t)[0]);if(e.setState({loading:"GUARDAR"}),e.state.rawFile){var a=e.state,n=(a.rawFile,Object(z.a)(a,["rawFile"]));return Ye(e.state.rawFile).then((function(e){return S.SaveProduct(Object(p.a)({imageFile:e},n))})).then(e._updated).catch(e._failed)}S.SaveProduct(e.state).then(e._updated).catch(e._failed)},e._updated=function(){e.setState({loading:null,error:null}),e.props.onDone(!0)},e._failed=function(t){e.setState({loading:null,error:t}),window.requestAnimationFrame((function(){try{document.getElementById("ERROR_MESSAGE").focus()}catch(e){}}))},e.handleClose=function(){e.state.loading||e.props.onDone()},e.handleFile=function(t){qe(t).then((function(a){return e.setState({imgSrc:a,rawFile:t})})).catch(e._failed)},e.handleAdd=function(t){var a=t.name,n=t.item,r=t.inputValue;e.setState((function(e){var t=Object(p.a)({},e);return"OPCIONES"===a?(t.opciones=t.opciones?Object(ae.a)(t.opciones):[],t.opciones.push({idOpcion:+n.id}),t):"COMPONENTES"===a?(t.componentes=t.componentes?Object(ae.a)(t.componentes):[],t.componentes.push({idComponente:+n.id,cantidad:+(r||1)}),t):void 0}))},e.handleRemove=function(t){var a=t.name,n=t.index;e.setState((function(e){var t=Object(p.a)({},e);return"OPCIONES"===a&&(t.opciones=Object(ae.a)(t.opciones),t.opciones.splice(n,1)),"COMPONENTES"===a&&(t.componentes=Object(ae.a)(t.componentes),t.componentes.splice(n,1)),t}))},e}return Object(c.a)(a,[{key:"_validar",value:function(e){var t={};if((e.nombre||"").trim()||(t.nombre="Digita el nombre"),(void 0===e.pvp_final||null===e.pvp_final?"":e.pvp_final).toString().trim()?isNaN(+e.pvp_final)&&(t.pvp_final="Precio final debe ser un n\xfamero"):t.pvp_final="Digita el Precio Final",e.opciones&&e.opciones.length&&!e.maxItems&&(t.maxItems="Digita la cantidad m\xe1xima a escoger"),e.sku&&e.sku.toString().trim().length||(t.sku="Digita el SKU (codigo)"),e.orden&&e.orden.toString().trim().length||(t.orden="Digita el orden en que aparecer\xe1 el producto"),e.descripcion_url&&e.descripcion_url.trim().length>300&&(t.descripcion_url="El enlace de la descripci\xf3n solo puede tener hasta 300 caracteres. Actualmente tiene ".concat(e.descripcion_url.trim().length)),Object.keys(t).length)return t}},{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.props.showingID,n=e.showingID;!!(null===a||void 0===a)&&!(null===n||void 0===n)&&this.setState((function(e){var a=t.props.productList.find((function(e){return e.id===+n}))||{},r=a.habilitado,o=Object(z.a)(a,["habilitado"]),i=Object.keys(t.state);return void 0!==r&&null!==r||(r=!0),Object(p.a)(Object(p.a)(Object(p.a)({},i.reduce((function(e,t){return Object(p.a)(Object(p.a)({},e),{},Object(h.a)({},t,void 0))}),{})),o),{},{habilitado:r})}))}},{key:"shouldComponentUpdate",value:function(e){var t=!(null===this.props.showingID||void 0===this.props.showingID);return t!==!(null===e.showingID||void 0===e.showingID)||!1!==t}},{key:"render",value:function(){var e=this,t=this.state.loading,a=this.props.showingID,n=this._validar(this.state)||{},o=!(null===a||void 0===a),i=(this.state.opciones||[]).map((function(t){return{id:t.idOpcion,nombre:(e.props.productList.find((function(e){return e.id===t.idOpcion}))||{}).nombre}})),l=(this.state.componentes||[]).map((function(t){return{id:t.idComponente,nombre:(e.props.productList.find((function(e){return e.id===t.idComponente}))||{}).nombre,cantidad:t.cantidad}})),c=this.props.productList.filter((function(e){return!e.combo&&e.id!==+a})),s=r.a.createElement(r.a.Fragment,null,r.a.createElement(we.a,{label:"Habilitado",style:{flexGrow:1},control:r.a.createElement(_e.a,{checked:!!this.state.habilitado,name:"habilitado",onChange:this.handleChecked})}),"NUEVO"!==a&&r.a.createElement(O.a,{disabled:!!t,onClick:this.handleDelete,color:"secondary",variant:"outlined"},"ELIMINAR"===t?"ELIMINANDO...":"ELIMINAR"),r.a.createElement(O.a,{disabled:!!t,onClick:this.handleSave,color:"primary",variant:"outlined"},"GUARDAR"===t?"GUARDANDO...":"GUARDAR"),r.a.createElement(O.a,{color:"inherit",disabled:!!t,onClick:this.handleClose},"SALIR"));return r.a.createElement(me,{title:"",onClose:this.handleClose,show:o,footer:s},r.a.createElement(Se,{value:this.state.nombre||"",onChange:this.handleChange,name:"nombre",required:!0,label:"Nombre",maxLength:100,error:n.nombre}),r.a.createElement(xe,{className:"card-product-img",onChange:this.handleFile,src:this.state.imgSrc,title:this.state.nombre}),r.a.createElement("div",{style:{textAlign:"center",marginBottom:10}},r.a.createElement(y.a,{variant:"caption"},"El peso recomendado para la imagen es entre 100 y 200 Kbs.")),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",textAlign:"center"}},r.a.createElement(Se,{type:"phone",value:void 0===this.state.pvp_final||null===this.state.pvp_final?"":this.state.pvp_final,onChange:this.handleChange,name:"pvp_final",required:!0,label:"Precio Final",maxLength:10,error:n.pvp_final,style:{marginRight:10}}),r.a.createElement(Se,{type:"phone",value:this.state.cantidad_desde||"",onChange:this.handleChange,name:"cantidad_desde",label:"Cantidad m\xednima",maxLength:2,error:n.cantidad_desde})),r.a.createElement(Se,{type:"url",value:this.state.descripcion_url||"",onChange:this.handleChange,name:"descripcion_url",required:!0,label:"Descripci\xf3n",maxLength:300}),r.a.createElement("div",{style:{marginTop:20,margin:"auto",display:"flex",flexDirection:"row"}},r.a.createElement(Se,{style:{flex:1,marginLeft:10,marginRight:10},value:this.state.sku||"",onChange:this.handleChange,name:"sku",required:!0,label:"SKU",maxLength:20,error:n.sku}),r.a.createElement(Se,{onChange:this.handleChange,value:this.state.orden||"",style:{width:100,marginLeft:10},name:"orden",required:!0,label:"Orden",maxLength:5,error:n.orden})),r.a.createElement("div",{style:{marginTop:20,margin:"auto",display:"flex",flexDirection:"row"}},r.a.createElement(we.a,{label:"Aplica a comisi\xf3n",control:r.a.createElement(_e.a,{checked:!!this.state.aplica_comision,name:"aplica_comision",onChange:this.handleChecked})}),r.a.createElement(we.a,{label:"Aplica a Descuento",control:r.a.createElement(_e.a,{checked:!!this.state.aplica_descuento,name:"aplica_descuento",onChange:this.handleChecked})})),r.a.createElement("div",{style:{marginTop:20,textAlign:"center",marginLeft:"auto",marginRight:"auto"}},r.a.createElement(we.a,{label:"El producto es un combo",control:r.a.createElement(_e.a,{checked:!!this.state.combo,name:"combo",onChange:this.handleChecked})})),this.state.combo&&r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{style:{marginTop:20},variant:"h6"},"COMPONENTES"),r.a.createElement(wa,{dataSource:c,items:l,onAdd:this.handleAdd,onRemove:this.handleRemove,IdProp:"id",DisplayProp:"nombre",SecondaryDisplayProp:"cantidad",InputConfig:{type:"number",label:"Cantidad"},name:"COMPONENTES"}),r.a.createElement(y.a,{style:{marginTop:20},variant:"h6"},"OPCIONES"),r.a.createElement(wa,{dataSource:c,items:i,onAdd:this.handleAdd,onRemove:this.handleRemove,IdProp:"id",DisplayProp:"nombre",name:"OPCIONES"}),r.a.createElement(Se,{type:"phone",value:this.state.maxItems||"",onChange:this.handleChange,name:"maxItems",label:"M\xe1ximo",maxLength:2,error:n.maxItems,style:{}}),r.a.createElement(y.a,{variant:"body2",color:"secondary",id:"ERROR_MESSAGE",tabIndex:0,style:{marginTop:10}},this.state.error&&this.state.error.message)))}}]),a}(r.a.Component),xa=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:[],loading:!0,error:null},e._Update=function(){S.GetProducts(!0).then((function(t){return e.setState({data:t,loading:!1})})).catch((function(t){return e.setState({loading:!1,error:t})}))},e.handleClick=function(t){e.props.history.push(e.props.match.path+"/"+t.currentTarget.value)},e.handleDone=function(t){t&&e._Update(),e.props.history.push(e.props.match.path)},e.handleAction=function(t){var a=t.currentTarget,n=a.name,r=a.value,o=e.productSorted(),i=o.find((function(e){return e.id===+r}));i&&("LEFT"===n&&0===o.indexOf(i)||"RIGHT"===n&&o.length===o.indexOf(i)+1||S.SendProductAction(r,n).then(e._Update).catch((function(t){return e.setState({error:t})})))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.onMounted&&this.props.onMounted(this.props.match.path),this._Update()}},{key:"productSorted",value:function(){return this.state.data.sort((function(e,t){return e.orden-t.orden}))}},{key:"render",value:function(){var e=this;return this.state.loading?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(V.a,{size:100}),r.a.createElement(y.a,{variant:"h6"},"CARGANDO...")):r.a.createElement("div",{style:{width:"calc(100% - 25px)",margin:"auto",marginTop:10}},r.a.createElement(te,{items:this.productSorted(),showNewItem:!0,visible:!0,onActionClick:this.handleAction,onCardClick:this.handleClick}),r.a.createElement(d.b,{path:this.props.match.path+"/:id",children:function(t){var a=t.match;return r.a.createElement(Ta,{productList:e.state.data,showingID:a&&a.params.id,onDone:e.handleDone})}}))}}]),a}(r.a.Component),ka=[{name:"id",label:"ID"},{name:"nombre",label:"Nombre"},{name:"ParentName",label:"Patrocinador"},{name:"parentId",label:"ID Patrocinador"},{name:"username",label:"Usuario"},{name:"Rol",label:"Rol"},{name:"ultimoPedido",options:{display:"none"}},{name:"UltimoPedido",label:"Ultimo Pedido"},{name:"Estado",label:"Estado"}],ja=a(512),Ia=function(e){return e.readOnly?r.a.createElement("div",{style:{marginTop:10,marginBottom:10}},r.a.createElement(y.a,{style:{display:"inline"}},"ROL: "),r.a.createElement(y.a,{style:{display:"inline"},variant:"button"},Pa(e.value))):r.a.createElement(Se,{select:!0,disabled:e.loading,value:e.value||"",name:"rol",label:"Rol",SelectProps:{native:!0},onChange:e.onChange},r.a.createElement("option",{value:"1"},Pa(1)),r.a.createElement("option",{value:"3"},Pa(3)))};function Pa(e){return 1===+e?"ASESOR/A":3===+e?"ADMINISTRADOR/A":""}var Ra=a(524);function Na(e){if(e.readOnlyValue)return r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(y.a,null,"Madre/Padre: "),r.a.createElement(y.a,{variant:"button"},e.readOnlyValue));var t=function(){var e=r.a.useState("LOADING"),t=Object(B.a)(e,2),a=t[0],n=t[1],o=r.a.useState([]),i=Object(B.a)(o,2),l=i[0],c=i[1],s=r.a.useState(null),u=Object(B.a)(s,2),d=u[0],m=u[1];return r.a.useEffect((function(){"LOADING"===a&&S.GetUsers(["id","nombre"],1).then((function(e){c(e),n("COMPLETED")})).catch((function(e){n("ERROR"),m(e)}))}),[a]),[l,a,d]}(),a=Object(B.a)(t,2),n=a[0],o=a[1];if(void 0!==e.value&&null!==e.value)var i=n.find((function(t){return t.id===e.value}));return void 0===i&&(i=null),r.a.createElement(Ra.a,{options:n,loading:"LOADING"===o,loadingText:"Cargando datos...",noOptionsText:"No se encontraron registros",renderInput:function(t){return r.a.createElement(Se,Object.assign({label:"LOADING"===o?"CARGANDO DATOS...":"Selecciona el Asesor/a Nat\xfa que te invit\xf3"},t,{error:e.error,name:"parentId"}))},getOptionLabel:function(e){return"".concat(e.id," - ").concat(e.nombre)},value:i,onChange:function(t,a){return e.onChange(a&&a.id)},getOptionSelected:function(e,t){return e.id===t.id}})}var La=function(e){var t=e.loading,a=(e.id,e.onSubmit),n=e.onChange,o=e.formType,i=e.editionType,l=Object(z.a)(e,["loading","id","onSubmit","onChange","formType","editionType"]);var c="EDIT"===o&&"USER"!==i||null,s="EDIT"===o&&"USER"!==i&&3===+l.rol||null,u="EDIT"===o&&"USER"!==i,d=e.error||{};return r.a.createElement("form",{style:{margin:"auto",maxWidth:600},noValidate:!0,onSubmit:function(e){e.preventDefault(),e.stopPropagation(),a()}},r.a.createElement(y.a,{variant:"h6"},"Informaci\xf3n Personal"),r.a.createElement(Se,{disabled:t,error:d.nombre,onChange:n,value:l.nombre||"",name:"nombre",label:"Nombres Completos"}),r.a.createElement(Se,{disabled:t,error:d.identificacion,onChange:n,value:l.identificacion||"",name:"identificacion",label:"Identificacion (CI o Pasaporte)",type:"phone"}),r.a.createElement(Se,{disabled:t,error:d.telefono,onChange:n,value:l.telefono||"",name:"telefono",label:"Telefono",type:"phone"}),r.a.createElement(Se,{disabled:t,error:d.email,onChange:n,value:l.email||"",name:"email",label:"Correo Electronico",type:"email"}),r.a.createElement(Se,{disabled:t,error:d.nacionalidad,onChange:n,value:l.nacionalidad||"",name:"nacionalidad",label:"Nacionalidad"}),r.a.createElement(Se,{InputLabelProps:{shrink:!0},disabled:t,error:d.fechaNacimiento,onChange:n,value:l.fechaNacimiento||"",name:"fechaNacimiento",label:"Fecha Nacimiento",type:"date"}),r.a.createElement(y.a,{variant:"h6",style:{marginTop:30}},"SIGN-IN"===o?"Agrega tu direcci\xf3n":"Direcci\xf3n"),r.a.createElement(Se,{disabled:t,error:d.ciudad,onChange:n,value:l.ciudad||"",name:"ciudad",label:"Ciudad"}),r.a.createElement(Se,{disabled:t,error:d.direccion,onChange:n,value:l.direccion||"",name:"direccion",label:"Direccion"}),r.a.createElement(y.a,{variant:"h6",style:{marginTop:30}},"SIGN-IN"===o?"Crea tu Usuario":"Usuario"),r.a.createElement(Se,{disabled:t,error:d.username,onChange:n,value:l.username||"",name:"username",label:"Usuario"}),r.a.createElement(Ua,{required:"SIGN-IN"===o,disabled:t,error:d.password,onChange:n,value:l.password||"",name:"password",label:"EDIT"===o?"Nueva contrase\xf1a":"Contrase\xf1a"}),r.a.createElement(Ua,{required:"SIGN-IN"===o,disabled:t,error:d.confirm_password,onChange:n,value:l.confirm_password||"",name:"confirm_password",label:"EDIT"===o?"confirma la nueva contrase\xf1a":"Confirma tu contrase\xf1a"}),r.a.createElement(Na,{value:l.parentId,readOnlyValue:"ADMIN"===i?void 0:l.ParentName,onChange:function(e){return n({currentTarget:{name:"parentId",value:e}})},error:d.parentId,loading:t}),"EDIT"===o?r.a.createElement(Ia,{value:""+(l.rol||""),loading:t,onChange:n,readOnly:"ADMIN"!==i}):null,c&&r.a.createElement(Se,{select:!0,disabled:t,value:void 0===l.estado||null===l.estado?"":l.estado.toString(),name:"estado",label:"Estado",SelectProps:{native:!0},onChange:n},r.a.createElement("option",{value:"1"},"PENDIENTE"),r.a.createElement("option",{value:"0"},"APROBADO (Habilitado)"),r.a.createElement("option",{value:"2"},"RECHAZADO (Deshabilitado)")),s&&r.a.createElement(we.a,{label:"Puede modificar precios durante toma de pedido",control:r.a.createElement(_e.a,{checked:Boolean(l.editarPVPsdurantePedido),name:"editarPVPsdurantePedido",onChange:n})}),u&&r.a.createElement("div",{style:{margin:"auto",textAlign:"center",paddingTop:20,paddingBottom:20}},r.a.createElement(we.a,{control:r.a.createElement("input",{type:"checkbox",onChange:n,name:"mustAcceptTermsAndConds",checked:l.mustAcceptTermsAndConds||!1}),label:"Mostrar Aceptar Terminos y Condiciones; y aceptar Pol\xedticas de privacidad al iniciar"}),l.termsAndCondsAcceptedAt&&r.a.createElement("div",{style:{marginTop:10}},r.a.createElement(y.a,{variant:"button"},"Este usuario ha aceptado los T\xe9rminos y Condiciones el:",new Date(l.termsAndCondsAcceptedAt).toLocaleString()))),d.guardar?r.a.createElement(y.a,{tabIndex:0,id:"guardar",color:"secondary"},d.guardar):null,"SIGN-IN"===o&&r.a.createElement(O.a,{type:"submit",color:"primary",variant:"outlined",fullWidth:!0,style:{marginTop:20}},t?r.a.createElement(V.a,{size:20,color:"inherit"}):"ENVIAR"),e.children)};function Ua(e){var t=e.error,a=Object(z.a)(e,["error"]),n=r.a.useState(!1),o=Object(B.a)(n,2),i=o[0],l=o[1],c={inputProps:{id:e.name}};return t&&(c.error=!0,c.helperText=t),r.a.createElement(v.a,Object.assign({type:i?"text":"password",required:!0,fullWidth:!0},a,c,{style:{marginTop:5,marginBottom:5},InputProps:{endAdornment:r.a.createElement(E.a,{position:"end"},r.a.createElement(b.a,{onClick:function(e){return l(!i)}},i?r.a.createElement(w.a,null):r.a.createElement(D.a,null)))}}))}function Ma(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.nombre,n=e.telefono,r=e.identificacion,o=e.email,i=e.fechaNacimiento,l=e.nacionalidad,c=e.ciudad,s=e.direccion,u=e.username,d=e.password,m=e.parentId,p=e.confirm_password,h={};if(Ga(a)&&(h.nombre="Digita tu nombre"),Ga(n)?h.telefono="Digita tu telefono":(isNaN(parseInt(n))&&(h.telefono="El telefono solo puede contener numeros"),n.length<=5&&(h.telefono="El telefono debe tener m\xednimo 6 digitos")),Ga(r)&&(h.identificacion="Digita tu identificacion"),Ga(o)?h.email="Digita tu email":(-1===o.indexOf("@")&&(h.email="El correo es incorrecto"),-1===o.indexOf(".")&&(h.email="El correo es incorrecto")),Ga(i)?h.fechaNacimiento="Digita tu fecha de nacimiento":isNaN(+new Date(i))&&(h.fechaNacimiento="La fecha no es v\xe1lida"),Ga(l)&&(h.nacionalidad="Digita tu nacionalidad"),Ga(c)&&(h.ciudad="Digita tu ciudad"),Ga(s)&&(h.direccion="Digita tu direccion"),Ga(u)&&(h.username="Digita tu Usuario"),Ga(d)?t.passwordOpcional||(h.password="Digita la contrase\xf1a"):(d.length<5&&(h.password="La contrase\xf1a debe tener m\xe1s de 6 caracteres"),d.trim()!==(p||"").trim()&&(h.confirm_password="Las contrase\xf1as no concuerdan entre si")),1!==e.id&&Ga(m)&&(h.parentId="Selecciona tu Mam\xe1 Nat\xfa"),Object.keys(h).length){var f=Object.keys(h)[0];return Fa(f),h}return null}function Fa(e){window.requestAnimationFrame((function(){try{document.getElementById(e).focus()}catch(t){}}))}function Ga(e){return null===e||(void 0===e||!e.toString().length)}var Ba=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.handleClose=function(){e.state.loading||e.props.onClose()},e.handleChange=function(t){var a=t.currentTarget,n=a.name,r=a.value,o=a.type,i=a.checked;r="checkbox"===o?i:r,e.setState(Object(h.a)({},n,r))},e.handleSubmit=function(){var t=e.state,a=t.loading,n=(t.error,t.validarPassword),r=Object(z.a)(t,["loading","error","validarPassword"]);if(!a){var o=Ma(r,{passwordOpcional:!n});if(o)return e.setState({error:o});e.setState({loading:!0}),S.SaveUser(r).then((function(t){return e.props.onClose(!0)})).catch((function(t){return e.setState({error:t,loading:!1},(function(){return Object.keys(t).forEach(Fa)}))}))}},e.handleDelete=function(t){e.state.id&&(e.state.loading||window.confirm("Deseas eliminar este usuario?")&&(e.setState({loading:!0}),S.DeleteUser(e.state.id).then((function(t){return e.props.onClose(!0)})).catch((function(t){return e.setState({error:{guardar:t.message},loading:!1},(function(){return mt("guardar")}))}))))},e}return Object(c.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.show,a=e.show;!t&&a&&this.setState((function(t){var a=Object.keys(t),n=Object(p.a)(Object(p.a)({},a.reduce((function(e,t){return Object(p.a)(Object(p.a)({},e),{},Object(h.a)({},t,void 0))}),{})),e.initialData||{});return void 0===n.estado&&(n.estado=1),void 0===n.rol&&(n.rol=1),n.validarPassword=!n.id,n}))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props.show;return t!==e.show||!1!==t}},{key:"render",value:function(){var e=this.props.grupos,t=this.state,a=t.loading,n=t.error,o=Object(z.a)(t,["loading","error"]),i=r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{disabled:a,variant:"outlined",onClick:this.handleDelete,color:"secondary"},"ELIMINAR"),r.a.createElement(O.a,{disabled:a,variant:"outlined",onClick:this.handleSubmit,color:"primary"},"GUARDAR"),r.a.createElement(O.a,{disabled:a,onClick:this.handleClose,color:"primary"},"SALIR"));return r.a.createElement(me,{show:this.props.show,title:"Usuario",footer:i,onClose:this.handleClose},r.a.createElement(La,Object.assign({formType:"EDIT",editionType:"ADMIN",grupos:e},o,{loading:a,error:n,onSubmit:this.handleSubmit,onChange:this.handleChange})))}}]),a}(r.a.Component),Va=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).unmounted=!1,e.state={data:[],grupos:[],loading:!0,error:null,downloadSeparator:","},e.FetchData=function(){e.setState({loading:!0}),Promise.all([S.GetUsers(),S.GetGroups()]).then((function(t){var a=Object(B.a)(t,2),n=a[0],r=a[1];e.unmounted||e.setState({grupos:r,data:(n||[]).map((function(e){return e.ultimoPedido&&(e.UltimoPedido=new Date(e.ultimoPedido).toLocaleDateString()),e})),loading:!1})})).catch((function(t){e.setState({loading:!1}),e.unmounted||e.reportError(t.message)}))},e.handleNew=function(){e.props.history.push(e.props.match.path+"/view/NUEVO")},e.handleClose=function(t){t&&e.FetchData(),e.props.history.push(e.props.match.path)},e.handleClick=function(t){var a=t[0];e.props.history.push(e.props.match.path+"/view/"+a)},e.handleTermsAndConds=function(){window.confirm("Esta seguro de Mostrar en TODOS los usuarios ACEPTAR TERMINOS Y CONDICIONES al entrar")&&S.SendUserAction("ACCEPT_TERMS_AND_CONDS","all").then(e.FetchData).catch((function(t){return e.reportError(t.message)}))},e}return Object(c.a)(a,[{key:"componentWillMount",value:function(){this.props.onMounted&&this.props.onMounted(this.props.match.path),this.FetchData()}},{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"reportError",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!this.unmounted){var n=new URLSearchParams({a:t||"Ocurri\xf3 un problema",b:e,focusafter:a});this.props.history.push(this.props.match.path+"/msg?"+n.toString())}}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.loading,o=t.grupos;t.downloadSeparator;return n?r.a.createElement("div",{style:{paddingTop:10,textAlign:"center"}},r.a.createElement(y.a,{variant:"h6"},"CARGANDO..."),r.a.createElement(V.a,{size:50,color:"primary"})):r.a.createElement("div",null,r.a.createElement(ga,{title:"",data:a,columns:ka,options:{selectableRows:"none",onRowClick:this.handleClick,customToolbar:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{maxWidth:100,minWidth:100,width:100}}),r.a.createElement(Ht.a,{title:"Mostrar en TODOS los usuarios ACEPTAR TERMINOS Y CONDICIONES al entrar"},r.a.createElement(b.a,{color:"secondary",onClick:e.handleTermsAndConds},r.a.createElement(ja.a,null))),r.a.createElement(Ht.a,{title:"Agregar Usuario"},r.a.createElement(b.a,{color:"primary",onClick:e.handleNew},r.a.createElement(J.a,null))))},customSort:function(e,t,a){var n=ka[t];return e.sort((function(e,r){var o=e.data[t],i=r.data[t];return"UltimoPedido"===n.name?(o=e.data[t-1]&&new Date(e.data[t-1]).valueOf()||0,i=r.data[t-1]&&new Date(r.data[t-1]).valueOf()||0):("string"===typeof o&&(o=o.toLowerCase().trim()),"string"===typeof i&&(i=i.toLowerCase().trim())),"desc"===a?o>i?-1:i>o?1:0:o<i?-1:i<o?1:0}))}}}),r.a.createElement(d.b,{path:this.props.match.path+"/msg",component:Re}),r.a.createElement(d.b,{path:this.props.match.path+"/view/:id",children:function(t){var n=t.match;return r.a.createElement(Ba,{show:!(!n||!n.params.id),grupos:o,initialData:n&&a.find((function(e){return e.id===+n.params.id})),onClose:e.handleClose})}}))}}]),a}(r.a.Component),Wa=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentWillMount",value:function(){this.props.onMounted&&this.props.onMounted(this.props.path)}},{key:"render",value:function(){return r.a.createElement("div",{id:"Iframe-Liason-Sheet",className:"iframe-border center-block-horiz "+(this.props.className||"")},r.a.createElement("div",{className:"responsive-wrapper responsive-wrapper-wxh-760x1200"},r.a.createElement("iframe",{title:"Politicas de Nat\xfa",src:this.props.TextSrc},"Cargando...")))}}]),a}(r.a.PureComponent),za=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={checked:!1,loading:!1},n.handleCheck=n.handleCheck.bind(Object(P.a)(n)),n.handleClick=n.handleClick.bind(Object(P.a)(n)),n}return Object(c.a)(a,[{key:"handleCheck",value:function(e){var t=e.currentTarget.checked;this.setState({checked:t})}},{key:"handleClick",value:function(e){var t=this;this.state.loading||this.state.checked&&(this.setState({loading:!0}),S.SendUserAction("ACCEPT_TERMS_AND_CONDS").then(this.props.onDone).catch((function(e){alert(e.message),t.setState({loading:!1})})))}},{key:"render",value:function(){var e=this.state,t=e.checked,a=e.loading;return r.a.createElement("div",{className:"full-height",style:{display:"flex",flexDirection:"column"}},r.a.createElement(Wa,{className:"iframe-wrapper-with-max-height",TextSrc:"https://docs.google.com/document/d/e/2PACX-1vQM7gflRmudx9mnIJpfZMu5gM3WUl3u_h8RRuyVbb6yErxWTnU_jeu8kcKUJhht3VadenapB4nINf7h/pub?embedded=true"}),r.a.createElement("div",{style:{margin:"auto",textAlign:"center",paddingTop:10,paddingBottom:10,width:"100%"}},r.a.createElement(we.a,{control:r.a.createElement("input",{disabled:a,checked:t,type:"checkbox",onChange:this.handleCheck}),label:"Acepto los t\xe9rminos y condiciones, y acepto la Pol\xedtica de Privacidad"}),r.a.createElement(O.a,{disabled:a||!t,color:"primary",variant:"contained",onClick:this.handleClick},"CONTINUAR")))}}]),a}(r.a.Component),Ha=function(e){var t=r.a.useState({}),a=Object(B.a)(t,2),n=a[0],o=a[1],i=r.a.useState(""),l=Object(B.a)(i,2),c=l[0],s=l[1],u=r.a.useState(void 0),d=Object(B.a)(u,2),m=d[0],f=d[1];r.a.useEffect((function(){e.onMounted&&e.match&&e.onMounted(e.match.path),S.GetUser(e.userId).then(o)}),[]),r.a.useEffect((function(){if(c){var t=Ma(n,{passwordOpcional:!0});if(t)return s(""),void f(t);S.SaveUser(n).then((function(t){s("GUARDADO"),f(void 0),e.onSubmit&&e.onSubmit()})).catch((function(e){s(""),f({guardar:e.message})}))}}),[c]);var g=void 0===n.id||"GUARDAR"===c;return r.a.createElement("div",{style:{padding:15}},r.a.createElement(La,Object.assign({onSubmit:function(){return s("GUARDAR")},onChange:function(e){o(Object(p.a)(Object(p.a)({},n),{},Object(h.a)({},e.target.name,e.target.value)))},error:m,formType:"EDIT",editionType:"USER",loading:g},n),r.a.createElement("div",{style:{padding:5}},r.a.createElement(O.a,{fullWidth:!0,type:"submit",color:"GUARDADO"===c?"secondary":"primary",disabled:g,variant:"outlined"},"GUARDADO"===c?"Listo!":"Actualizar datos"))))},qa=Object(Be.a)({reducer:{Order:it}}),Ya=function(e){var t=r.a.useState(e.tabs[0].tabId),a=Object(B.a)(t,2),n=a[0],o=a[1];r.a.useEffect((function(){e.onMounted&&e.match&&e.onMounted(e.match.path)}),[]);var i=e.tabs.find((function(e){return e.tabId===n}));if(i)var l=r.a.createElement(i.Component,null);return r.a.createElement("div",null,r.a.createElement(U.a,{value:n,onChange:function(e,t){return o(t)}},e.tabs.map((function(e){return r.a.createElement(M.a,{key:e.tabId,value:e.tabId,label:e.tabLabel})}))),l)},Ka=function(e){var t=r.a.useState("fetch_products"),a=Object(B.a)(t,2),n=a[0],o=a[1],i=r.a.useState(da("yyyy-MM-dd",new Date)),l=Object(B.a)(i,2),c=l[0],s=l[1],u=r.a.useState(da("yyyy-MM-dd",new Date)),d=Object(B.a)(u,2),m=d[0],p=d[1],h=r.a.useState(""),f=Object(B.a)(h,2),g=f[0],E=f[1],b=r.a.useState([]),C=Object(B.a)(b,2),A=C[0],D=C[1],w=r.a.useState([]),_=Object(B.a)(w,2),T=_[0],x=_[1];r.a.useEffect((function(){if("fetch_products"===n&&S.GetProducts().then((function(e){x(e.filter((function(e){return!(e.componentes&&e.componentes.length||e.opciones&&e.opciones.length)})).map((function(e){return{id:e.id,nombre:e.nombre,cantidad:""}}))),o("")})),"guardar"===n){var t=function(e,t,a,n){var r={desde:null,hasta:null,condiciones:[],regalos:[]};try{r.desde=da.parse("yyyy-MM-dd hh:mm:ss.SSS",e+" 00:00:00.000")}catch(o){return{error:"La fecha `Desde` no es correcta"}}try{r.hasta=da.parse("yyyy-MM-dd hh:mm:ss.SSS",t+" 23:59:59.999")}catch(o){return{error:"La fecha `Hasta` no es correcta"}}return a&&+a>0&&!isNaN(+a)?(r.condiciones.push({propName:"pedido.subtotal",value:a,operator:">="}),n&&n.length&&!n.find((function(e){return isNaN(+e.cantidad)||!+e.cantidad}))?(r.regalos=n,{data:r}):{error:"Seleccione al menos un producto y agregue una cantidad mayor a 0"}):{error:"El valor de `Pedido Subtotal` no es valido"}}(c,m,g,A);if(t.error)return o(t.error);S.SaveGiftRule(t.data).then((function(t){return e.onClose(!0)})).catch((function(e){return o(e.message)}))}}),[n]);var k=["guardar","eliminar","fetch_products","fetch_record"].indexOf(n)>=0,j=!k&&n.length?n:null;return r.a.createElement(ne.a,{open:!0,onClose:function(){k||e.onClose()}},r.a.createElement(le.a,null,r.a.createElement("div",null,r.a.createElement(v.a,{value:c,onChange:function(e){return s(e.target.value)},label:"Desde",type:"date"}),r.a.createElement(v.a,{value:m,onChange:function(e){return p(e.target.value)},label:"Hasta",type:"date"})),r.a.createElement(v.a,{label:"Pedido.Subtotal",value:g,onChange:function(e){return E(e.target.value)},type:"number",inputProps:{step:"0.01"}}),r.a.createElement(y.a,null,"Productos a Regalar"),r.a.createElement(wa,{dataSource:T,DisplayProp:"nombre",IdProp:"id",items:A,onAdd:function(e){var t=Object(ae.a)(A);t.push({cantidad:e.inputValue,nombre:e.item.nombre,id:e.item.id}),D(t)},onRemove:function(e){var t=Object(ae.a)(A),a=t.indexOf(e.item);a<0||(t.splice(a,1),D(t))},InputConfig:{allowZero:!1,label:"Cantidad",type:"number"},SecondaryDisplayProp:"cantidad"})),r.a.createElement(ce.a,null,j&&r.a.createElement(y.a,{color:"error"},j),r.a.createElement(O.a,{disabled:k,type:"button",onClick:function(){return e.onClose()}},"SALIR"),r.a.createElement(O.a,{disabled:k,type:"button",onClick:function(){return o("guardar")}},"GUARDAR")))};var Za=[{tabId:"gift-rules",Component:function(){var e=r.a.useState([]),t=Object(B.a)(e,2),a=t[0],n=t[1],o=r.a.useState("data"),i=Object(B.a)(o,2),l=i[0],c=i[1],s=r.a.useState(!1),u=Object(B.a)(s,2),d=u[0],m=u[1];r.a.useEffect((function(){"data"===l&&S.GetGiftRules(!0).then((function(e){n(e.map((function(e){return{ID:e.id,Productos:e.regalos.map((function(e){return"".concat(e.nombre," x").concat(e.cantidad)})).join(", "),Condiciones:e.condiciones.map((function(e){return"".concat(e.propName," ").concat(e.operator," ").concat(e.value)})).join("y "),Desde:new Date(e.desde).toLocaleDateString("es-EC",{month:"short",day:"numeric",year:"numeric"}),Hasta:new Date(e.hasta).toLocaleDateString("es-EC",{month:"short",day:"numeric",year:"numeric"})}})))})).catch((function(e){alert(e.message)})).then((function(){c("")})),0===l.indexOf("delete:")&&S.DeleteGiftRule(+l.split(":")[1]).then((function(){c("data")})).catch((function(e){c(e.message)}))}),[l]);var p=l.indexOf("delete:")>=0||"data"===l||null,h=l.length&&!p?l:null,f=!!d||null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{textAlign:"center"}},h&&r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{variant:"h4",color:"error"},"Ocurri\xf3 un error"),r.a.createElement(y.a,{variant:"h6",color:"error"},h))),r.a.createElement(ga,{title:"",columns:[{name:"ID"},{name:"Condiciones"},{name:"Desde"},{name:"Hasta"},{name:"Productos"}],data:a,options:{print:!1,download:!1,sort:!1,filter:!1,search:!1,viewColumns:!1,pagination:!1,selectableRows:"single",onRowsDelete:function(e){return!!window.confirm("Desea eliminar el registro?")&&c("delete:"+a[e.data[0].index].ID)},textLabels:{body:{noMatch:p?"Buscando Registros \ud83d\udd0e .... ":"No se encontraron registros \ud83e\udd37\u200d\u2640\ufe0f"}},customToolbar:function(){return r.a.createElement(Ht.a,{title:"Agregar Regla"},r.a.createElement(b.a,{color:"primary",onClick:function(){return m(!0)}},r.a.createElement(J.a,null)))}}}),f&&r.a.createElement(Ka,{onClose:function(e){m(!1),e&&c("data")}}))},tabLabel:"Reglas de Regalos"}],Ja=function(e){return r.a.createElement(Ya,{match:e.match,onMounted:e.onMounted,tabs:Za})},Xa=[{name:"id",label:"ID"},{name:"nombre",label:"Nombre"},{name:"parent1",label:"ID Patrocinador"},{name:"total_comisionable",label:"Venta Individual Comisionable"},{name:"total_calificable",label:"Venta Individual"},{name:"nX_total_calificable",label:"Venta Grupal"},{name:"n1_comisionable",label:"Comisionable N1"},{name:"n1_activos",label:"Activos N1"},{name:"n2_comisionable",label:"Comisionable N2"},{name:"n2_activos",label:"Activos N2"},{name:"n3_comisionable",label:"Comisionable N3"},{name:"n3_activos",label:"Activos N3"},{name:"titulo",label:"Titulo"},{name:"subtotal_comision",label:"Comision a Pagar"},{name:"total_comision",label:"Total a Pagar"}];var Qa=[{tabId:"cycles",tabLabel:"Ciclos",Component:function(){var e=r.a.useState("fetch_cycles"),t=Object(B.a)(e,2),a=t[0],n=t[1],o=r.a.useState(null),i=Object(B.a)(o,2),l=i[0],c=i[1],s=r.a.useState([]),u=Object(B.a)(s,2),d=u[0],m=u[1],p=r.a.useState([]),h=Object(B.a)(p,2),f=h[0],g=h[1];r.a.useEffect((function(){if("fetch_data"===a){if(!(l&&l.index>=0))return n("Selecciona un ciclo v\xe1lido");S.GetMultiLevelUserData(l).then((function(e){g(e),n("")})).catch((function(e){return n(e.message)}))}"fetch_cycles"===a&&S.GetCycles().then((function(e){m(e),n("")})).catch((function(e){return n(e.message)}))}),[a]);var y=["fetch_data","fetch_cycles","validate_data","submit_data"].indexOf(a)>=0,C=y||!a.length?"":a,A=y||!(l&&l.index>=0);return r.a.createElement(ga,{title:y?"Cargando datos...":C,columns:Xa,data:f,options:{selectableRows:"none",textLabels:{body:{noMatch:"No se encontraron registros"}},customToolbar:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{style:{margin:5,minWidth:200},select:!0,disabled:y,value:l?l.index:"",onChange:function(e){c(d.find((function(t){return t.index.toString()==e.target.value})))},SelectProps:{native:!0},InputProps:{startAdornment:r.a.createElement(E.a,{position:"start"},r.a.createElement(b.a,{disabled:A,type:"button",onClick:function(){return n("fetch_data")}},r.a.createElement(ee.a,null)))}},r.a.createElement("option",null,"- Selecciona un ciclo -"),d.map((function(e){return r.a.createElement("option",{key:e.number+"-"+e.year,value:e.index},e.year," - Ciclo ",e.number)}))),r.a.createElement("div",{style:{minWidth:100,width:100,minHeight:20}}),r.a.createElement(O.a,{disabled:A||!f.length,color:"primary",variant:"contained",type:"button",onClick:function(){return n("validate_data")}},"GUARDAR Y CERRAR CICLO \ud83d\udd12"))}}})}}],$a=function(e){return r.a.createElement(Ya,{tabs:Qa,match:e.match,onMounted:e.onMounted})},en=a(294),tn=a(59),an=a(513),nn=a(514),rn=a(515),on=a(516),ln=a(517),cn=a(518),sn=a(519),un=a(520),dn=a(521),mn=a(522),pn=a(309),hn=a.n(pn),fn=[{label:"Inicio",Icon:an.a,path:"/feed"},{label:"Nuevo Pedido",Icon:nn.a,path:"/order"},{label:"Pedidos",Icon:rn.a,path:"/my-orders",roles:[1,2]},{label:"Pedidos",Icon:rn.a,path:"/queue",roles:[3]},{label:"Politicas",Icon:ja.a,path:"/policy"},{label:"Cat\xe1logo",Icon:on.a,path:"/products",roles:[3]},{label:"Usuarios",Icon:ln.a,path:"/users",roles:[3]},{label:"Reportes",Icon:cn.a,path:"/reports",roles:[3]},{label:"Ciclos",Icon:sn.a,path:"/multi-level-cycle",roles:[3]},{label:"Perfil",Icon:un.a,path:"/my-profile"},{label:"Configuraci\xf3n",Icon:hn.a,path:"/settings",roles:[3]}],gn=Object(en.a)((function(e){return{drawer:Object(h.a)({},e.breakpoints.up("sm"),{width:200,flexShrink:0}),toolbar:e.mixins.toolbar,drawerPaper:{width:200,background:e.palette.primary.light,color:e.palette.primary.contrastText},icons:{color:e.palette.primary.contrastText},appBar:{display:"block"}}})),vn=function(e){var t=e.window?e.window().document.body:void 0,a=e.username,o=e.ParentName,i=(e.rangoHonorifico,e.selectedPath),l=r.a.useState(!1),c=Object(B.a)(l,2),s=c[0],u=c[1],d=r.a.useState({id:"-1",nombre:""}),m=Object(B.a)(d,2),p=m[0],h=m[1],f=gn();r.a.useEffect((function(){p.id!==e.rangoHonorifico&&S.Rangos().then((function(t){var a=t.find((function(t){return e.rangoHonorifico===t.id}));a&&h(a)})).catch((function(e){return h({id:"-1",nombre:"Rango no encontrado"})}))}),[e.rangoHonorifico]);var g=Object(n.useMemo)((function(){return fn.filter((function(t){return(t.roles||[e.rol]).indexOf(e.rol)>=0}))}),[e.rol]),v=r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},r.a.createElement(y.a,{style:{display:"block"},variant:"button"},a),r.a.createElement(y.a,{style:{display:"block"},variant:"caption"},"PATROCINADOR:"),r.a.createElement(y.a,{style:{display:"block"},variant:"caption"},o),r.a.createElement(y.a,{style:{display:"block"},variant:"button"},p.nombre)),r.a.createElement(fe.a,{style:{flex:1}},g.map((function(e){return r.a.createElement(ge.a,{onClick:function(){return u(!1)},selected:i===e.path,component:_.b,to:e.path,button:!0,key:e.label},r.a.createElement(Sa.a,null,r.a.createElement(e.Icon,{className:f.icons})),r.a.createElement(Le.a,{primaryTypographyProps:{variant:"button",style:{fontWeight:i===e.path?"bolder":"normal"}},primary:e.label}))}))),r.a.createElement(ge.a,{className:"a-link",component:"a",target:"_a",href:"https://wa.me/"},r.a.createElement(Sa.a,null," ",r.a.createElement(dn.a,{className:f.icons})," "),r.a.createElement(Le.a,{primaryTypographyProps:{variant:"button"},primary:"AYUDA"})));return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:f.drawer},r.a.createElement(L.a,{smUp:!0,implementation:"css"},r.a.createElement(tn.a,{container:t,variant:"temporary",anchor:"left",open:s,onClose:function(){return u(!1)},classes:{paper:f.drawerPaper},ModalProps:{keepMounted:!0}},r.a.createElement("div",{className:f.toolbar,style:{textAlign:"right"}},r.a.createElement(b.a,{onClick:function(){return u(!1)}},r.a.createElement(ue.a,{className:f.icons}))),v)),r.a.createElement(L.a,{xsDown:!0,implementation:"css"},r.a.createElement(tn.a,{classes:{paper:f.drawerPaper},variant:"permanent",open:!0},v))),r.a.createElement(L.a,{smUp:!0,implementation:"css"},r.a.createElement(re.a,{position:"fixed"},r.a.createElement(oe.a,null,r.a.createElement(b.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:function(){return u(!0)}},r.a.createElement(mn.a,null)),r.a.createElement(y.a,{style:{flexGrow:1}},(fn.find((function(e){return e.path===i}))||{}).label)))))},En=Object(R.a)((function(e){return{toolbar:e.mixins.toolbar,content:Object(h.a)({flexGrow:1},e.breakpoints.up("sm"),{marginLeft:200})}}))(function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={selected:"",editarPVPsdurantePedido:!1,username:"",userId:void 0,ParentName:"",rangoHonorifico:"",token:"",rol:0,descuentos:[],mustAcceptTermsAndConds:!1,solicitarDatosAlIniciar:!1},n.onMounted=n.onMounted.bind(Object(P.a)(n)),n.TermsAndCondsAccepted=n.TermsAndCondsAccepted.bind(Object(P.a)(n)),n.state.username=e.username,n.state.ParentName=e.ParentName,n.state.rangoHonorifico=e.rangoHonorifico,n.state.rol=e.rol,n.state.descuentos=e.descuentos||[],n.state.editarPVPsdurantePedido=e.editarPVPsdurantePedido,n.state.mustAcceptTermsAndConds=e.mustAcceptTermsAndConds,n.state.solicitarDatosAlIniciar=e.solicitarDatosAlIniciar,n.state.userId=e.id,n}return Object(c.a)(a,[{key:"onMounted",value:function(e){this.setState({selected:e})}},{key:"handleMenu",value:function(){this.setState((function(e){var t=Object(p.a)({},e);return t.isMenuOpen=!t.isMenuOpen,t}))}},{key:"TermsAndCondsAccepted",value:function(){this.setState({mustAcceptTermsAndConds:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.mustAcceptTermsAndConds,n=t.solicitarDatosAlIniciar,o=this.props,i=(o.window,o.classes);return a?r.a.createElement(za,{onDone:this.TermsAndCondsAccepted}):n?r.a.createElement("div",{style:{textAlign:"center",paddingTop:15}},r.a.createElement(y.a,{variant:"overline"},"Hola! estamos actualizando la informaci\xf3n de nuestros miembros. Por favor llena los campos que faltan para continuar."),r.a.createElement(Ha,{userId:this.state.userId,onSubmit:function(){return e.setState({solicitarDatosAlIniciar:!1})}})):r.a.createElement(_.a,{basename:"/app"},r.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"}},r.a.createElement(N.a,null),r.a.createElement(vn,{ParentName:this.state.ParentName,rol:this.state.rol,selectedPath:this.state.selected,username:this.state.username,rangoHonorifico:this.state.rangoHonorifico,window:this.props.window}),r.a.createElement("main",{className:i.content},r.a.createElement(Ge.a,{store:qa},r.a.createElement(L.a,{smUp:!0,implementation:"css"},r.a.createElement("div",{className:i.toolbar})),null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/feed",render:function(t){return r.a.createElement(ra,Object.assign({},t,{onMounted:e.onMounted,username:e.state.username,rol:e.state.rol}))}}),r.a.createElement(d.b,{path:"/order",render:function(t){return r.a.createElement(ut,{onMounted:e.onMounted,rol:e.state.rol,descuentos:e.state.descuentos,editablePrices:e.state.editarPVPsdurantePedido})}}),r.a.createElement(d.b,{path:"/my-orders",render:function(t){return r.a.createElement(Dt,Object.assign({},t,{rol:e.state.rol,onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/queue",render:function(t){return r.a.createElement(Aa,Object.assign({},t,{onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/policy",render:function(t){return r.a.createElement(Wa,{onMounted:e.onMounted,path:t.match&&t.match.path,TextSrc:"https://docs.google.com/document/d/e/2PACX-1vSC-0iC8dbpYgrNhlDyRWAQdwdFM4esg40JLZQS-zg6Koix_w1B86KoGI3YPpq-TdNjoJV0eenbcRKv/pub?embedded=true"})}}),r.a.createElement(d.b,{path:"/users",render:function(t){return r.a.createElement(Va,Object.assign({},t,{onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/products",render:function(t){return r.a.createElement(xa,Object.assign({},t,{onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/reports",render:function(t){return r.a.createElement(pa,Object.assign({},t,{rol:e.state.rol,onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/my-profile",render:function(t){return r.a.createElement(Ha,Object.assign({},t,{userId:e.state.userId,onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/settings",render:function(t){return r.a.createElement(Ja,Object.assign({},t,{onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/multi-level-cycle",render:function(t){return r.a.createElement($a,Object.assign({},t,{onMounted:e.onMounted}))}}),r.a.createElement(d.b,{path:"/",exact:!0},r.a.createElement(d.a,{to:"/feed"})))))))}}]),a}(r.a.Component)),bn=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={nombre:"",identificacion:"",telefono:"",email:"",fechaNacimiento:"",nacionalidad:"",ciudad:"",direccion:"",username:"",password:"",confirm_password:"",error:null,parentId:null,loading:!1,fin_registro:null},e.handleChange=function(t){var a=t.currentTarget,n=a.name,r=a.value;e.setState(Object(h.a)({},n,r))},e.handleSubmit=function(){if(!e.state.loading){var t=Ma(e.state);if(t)return e.setState({error:t});e.setState({loading:!0,error:null}),setTimeout((function(){S.SignIn(Object(p.a)(Object(p.a)({},e.state),{},{rol:Mt.ASESOR})).then((function(t){e.setState({loading:!1,fin_registro:t.email}),x.Set("user",e.state.username)})).catch((function(t){return e.setState({error:t,loading:!1},(function(){Object.keys(t).forEach((function(e){Fa(e)}))}))}))}),2e3)}},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.state,t=e.fin_registro,a=Object(z.a)(e,["fin_registro"]);return t?r.a.createElement("div",{style:{width:"100%",padding:30,textAlign:"center"}},r.a.createElement(y.a,{variant:"h4"},"Registro completado!"),r.a.createElement(y.a,{variant:"subtitle1"},"Para habilitar tu cuenta entra a tu correo (",t,") y abre el enlace que te enviamos."),r.a.createElement(y.a,{variant:"body1"},"Si no encuentras nuestro correo en tu Bandeja de Entreda, es posible que encuentre en SPAM o NO DESEADOS.")):r.a.createElement("main",{style:{width:"100%",padding:10,textAlign:"center",backgroundColor:"#fafafa"}},r.a.createElement(F.a,{style:{padding:20,margin:"auto",maxWidth:600}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("img",{style:{height:100},src:"./logo.png",alt:"Natu - Logo"}),r.a.createElement("div",{style:{flexGrow:1,margin:20,textAlign:"left"}},r.a.createElement(y.a,{variant:"h4"},"REGISTRATE"),r.a.createElement(y.a,{component:_.b,to:"/login"},"Ya tienes una cuenta? Inicia sesi\xf3n aqu\xed"))),r.a.createElement(C.a,null),r.a.createElement(La,Object.assign({editionType:"USER"},a,{onChange:this.handleChange,onSubmit:this.handleSubmit,formType:"SIGN-IN"}))))}}]),a}(r.a.Component),yn=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:void 0},n.history=Object(m.b)(),n.handleLoggedIn=function(e){if(n.setState({user:e}),"PENDIENTE"===e.estado)return n.history.push("/classroom");n.history.push("/app"),S.KEY=e.token;try{x.setPrefix(e.id?e.id+"_":"")}catch(t){console.info("Ocurrio un error en Preferences.setPrefix",t)}},e.user&&(n.state.user=e.user,S.KEY=e.user.token),n}return Object(c.a)(a,[{key:"render",value:function(){var e,t=this,a=this.state.user;if(a)switch(a.estado){case"PENDIENTE":e=r.a.createElement(d.b,null,"BIENVENIDO A CLASSROOM");break;case"RECHAZADO":e=r.a.createElement(d.b,null,"USUARIO EST\xc1 DESHABILITADO");break;default:e=r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/classroom"},"BIENVENIDO A CLASSROOM"),r.a.createElement(d.b,{path:"/app",render:function(){return r.a.createElement(En,a)}}),r.a.createElement(d.b,null,r.a.createElement(d.a,{to:"/app"})))}return r.a.createElement(d.c,{history:this.history},a?e:r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/signin",component:bn}),r.a.createElement(d.b,{path:"/recover-password"},"AQUI PUEDE RECUPERAR TU CONTRAE\xd1A"),r.a.createElement(d.b,{path:"/login",render:function(e){return r.a.createElement(k,{onLoggedIn:t.handleLoggedIn})}}),r.a.createElement(d.b,null,r.a.createElement(d.a,{to:"/login"}))))}}]),a}(r.a.Component),On=a(92),Cn=a(508),An=Object(On.a)({palette:{primary:{main:"#9f7c3a",contrastText:"#fff"},secondary:{main:"#be6337",contrastText:"#fff"}}});i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Cn.a,{theme:An},r.a.createElement(yn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[322,1,2]]]);
//# sourceMappingURL=main.99348233.chunk.js.map